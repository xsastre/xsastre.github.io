
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://xsastre.github.io/7.7.Laravel_validacio.html">
      
      
      
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>Formularis i validació de dades - Docencia Xavier</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans Condensed";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#formularis-i-validacio-de-dades" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Capçalera">
    <a href="." title="Docencia Xavier" class="md-header__button md-logo" aria-label="Docencia Xavier" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docencia Xavier
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Formularis i validació de dades
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Canviar a mode dia"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Canviar a mode dia" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Neteja" aria-label="Neteja" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicialitzant cerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegació" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Docencia Xavier" class="md-nav__button md-logo" aria-label="Docencia Xavier" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Docencia Xavier
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Inici
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Inici
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inici
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DWEC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            DWEC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Moduls/DWEC/_DWEC2425.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desenvolupament web en entorn client - DAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Moduls/DWEC/desenvolupamentfrontend.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desenvolupamet frontend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AW
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            AW
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Moduls/AW/01.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aplicacions web
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="formularis-i-validacio-de-dades">Formularis i validació de dades<a class="headerlink" href="#formularis-i-validacio-de-dades" title="Permanent link">&para;</a></h1>
<p><a href="#validació-de-formularis">Validació de Formularis</a></p>
<p><a href="#casos-especials">Casos Especials</a></p>
<p><a href="#exercisis">Exercisis</a></p>
<p><a href="#videoclub">Exemple</a></p>
<h2 id="dades-dentrada"><a href="https://laravel.com/docs/8.x/requests#retrieving-input">Dades d'entrada</a><a class="headerlink" href="#dades-dentrada" title="Permanent link">&para;</a></h2>
<p>Laravel facilita l'accés a les dades d'entrada de l'usuari a través de solament uns pocs mètodes. No importa el tipus de petició que s'haja realitzat (POST, GET, PUT, DELETE), si les dades són d'un formulari o si s'han afegit a la query string, en tots els casos s'obtindran de la mateixa forma.</p>
<p>Per a aconseguir accés a aquests mètodes Laravel utilitza <strong>injecció de dependències</strong>. Açò és simplement afegir la classe <strong>Request</strong> al constructor o mètode del controlador en el qual ho necessitem. Laravel s'encarregarà d'injectar aquesta dependència ja inicialitzada i directament podrem usar aquest paràmetre per a obtenir les dades d'entrada. </p>
<h3 id="creacio-i-enviament-de-formularis">Creació i enviament de formularis<a class="headerlink" href="#creacio-i-enviament-de-formularis" title="Permanent link">&para;</a></h3>
<p>Si definim un formulari en una vista, es defineix amb els conceptes que ja sabem d'HTML. Com a únic afegit, en el camp <strong>action</strong> del formulari podem utilitzar Blade i la funció <strong>route</strong> per a indicar el nom de ruta a la qual volem enviar el formulari.
Vegem, per exemple, com definir un formulari per a donar d'alta noves pelicules.
Creem una vista anomenada <strong>create.blade.php</strong> en la subcarpeta
<strong>resources/views/catalog</strong> , amb un contingut com aquest:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>@extends(&#39;plantilla&#39;)
<span class="linenos" data-linenos=" 2 "></span>@section(&#39;titulo&#39;, &#39;Nueva Pelicula&#39;)
<span class="linenos" data-linenos=" 3 "></span>@section(&#39;contenido&#39;)
<span class="linenos" data-linenos=" 4 "></span>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Nueva pelicula<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 5 "></span>    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;{{ route(&#39;catalog.store&#39;) }}&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&#39;POST&#39;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 6 "></span>        @csrf
<span class="linenos" data-linenos=" 7 "></span>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 8 "></span>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;title&quot;</span><span class="p">&gt;</span>Título<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos=" 9 "></span>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="10 "></span>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="11 "></span>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="12 "></span>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#39;year&#39;</span><span class="p">&gt;</span>Any:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="13 "></span>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;number&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;year&#39;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="14 "></span>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="15 "></span>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="16 "></span>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#39;director&#39;</span><span class="p">&gt;</span>Director:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="17 "></span>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;text&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;director&#39;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="18 "></span>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="19 "></span>           <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="20 "></span>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#39;poster&#39;</span><span class="p">&gt;</span>Poster:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="21 "></span>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;url&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;poster&#39;</span> <span class="p">/&gt;</span>
<span class="linenos" data-linenos="22 "></span>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="23 "></span>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="24 "></span>                <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;synopsis&quot;</span><span class="p">&gt;</span>Resumen<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="25 "></span>                <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;synopsis&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;synopsis&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">rows</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="26 "></span>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="27 "></span>             <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group text-center&quot;</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="28 "></span>                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-primary&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;padding:8px 100px;margin-top:25px;&quot;</span><span class="p">&gt;</span>Afegir pel.lícula<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="29 "></span>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="linenos" data-linenos="30 "></span>    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span> 
<span class="linenos" data-linenos="31 "></span>@endsection
</code></pre></div>
<p>Un segon afegit més que hem de tindre en compte és que Laravel per defecte protegeix d'atacs XSS (Cross Site Scripting) de suplantació d'identitat, per la qual cosa obtindrem un error de tipus 419 si enviem un formulari no validat. Per a solucionar aquest problema, n'hi ha prou amb utilitzar la directiva <strong>@csrf</strong>
en el formulari, que afig un camp ocult amb un <strong>token</strong> de validació de l'usuari.</p>
<p>En qualsevol cas, aquest formulari s'enviarà a la ruta indicada, que serà el mètode store de catalog que s'encarregarà de recollir les dades de la petició a través del paràmetre <strong>Request</strong> d'aquest mètode. Disposem d'un mètode <strong>get</strong> per a accedir a cada camp del formulari a partir del seu nom:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">public function store(Request $request)</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    $movie = new Movie();</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    $movie-&gt;titulo = $request-&gt;get(&#39;titulo&#39;);</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    $movie-&gt;director = $request-&gt;get(&#39;director&#39;);</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    $movie-&gt;year = $request-&gt;get(&#39;year&#39;);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    ..</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    $movie-&gt;save();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    return redirect()-&gt;route(&#39;movie.index&#39;);</span>
<span class="linenos" data-linenos="10 "></span><span class="x">}</span>
</code></pre></div>
<p>En aquest exemple com es pot veure s'ha afegit la classe Request com a paràmetre al mètode store. Laravel automàticament s'encarrega d'injectar aquestes dependències pel que directament podem usar la variable <strong>$request</strong> per a obtenir les dades d'entrada.</p>
<p>Si el mètode del controlador tinguera més paràmetres simplement els haurem d'afegir a continuació de les dependències, per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    public function edit(Request $request, $id) {</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    //... }</span>
</code></pre></div>
<p>A continuació veurem els mètodes i dades que podem obtenir a partir de la variable $request.</p>
<h4 id="obtenir-els-valors-dentrada">Obtenir els valors d'entrada<a class="headerlink" href="#obtenir-els-valors-dentrada" title="Permanent link">&para;</a></h4>
<p>Per a obtenir el valor d'una variable d'entrada usem el mètode <strong>input</strong> indicant el nom de la variable: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    $name = $request-&gt;input(&#39;nom&#39;);</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    // O simplement....</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    $name = $request-&gt;nom;</span>
</code></pre></div>
<p>També podem especificar un valor per defecte com a segon paràmetre: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    $name = $request-&gt;input(&#39;nom&#39;, &#39;Pedro&#39;);</span>
</code></pre></div>
<h4 id="comprovar-si-una-variable-existeix">Comprovar si una variable existeix<a class="headerlink" href="#comprovar-si-una-variable-existeix" title="Permanent link">&para;</a></h4>
<p>Si ho necessitem podem comprovar si un determinat valor existeix en les dades d'entrada: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    if ($request-&gt;has(&#39;nom&#39;)) { //...}</span>
</code></pre></div>
<h3 id="actualitzacions-i-esborrats">Actualitzacions i esborrats<a class="headerlink" href="#actualitzacions-i-esborrats" title="Permanent link">&para;</a></h3>
<p>Per defecte, l'atribut <strong>method</strong> d'un formulari només admet els valors GET o POST. Si volem enviar un formulari d'actualització o esborrat, aquest ha d'anar associat als mètodes <strong>PUT</strong> o <strong>DELETE</strong>,respectivament. Per a això, podem emprar dins del mateix formulari la directiva <strong>@method</strong> ,indicant el nom del mètode que volem usar:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">&lt;form ...&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="x">    @csrf</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    @method(&#39;PUT&#39;)</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    ...</span>
<span class="linenos" data-linenos="5 "></span><span class="x">&lt;/form&gt;</span>
</code></pre></div>
<h2 id="validacio-de-formularis">Validació de formularis<a class="headerlink" href="#validacio-de-formularis" title="Permanent link">&para;</a></h2>
<p>A més d'aplicar una validació en el client a través d'HTML5, que també és recomanable, s'han de validar les dades en el servidor. Per a fer això, el propi objecte <strong>request</strong> proporciona un mètode anomenat <strong>validate</strong> , al qual li passem un array amb les regles de validació.
Per exemple, així comprovaríem que el títol i l'editorial s'han enviat, i que el títol té una grandària mínima de 3 caràcters. A més, comprovem que el preu és un valor numèric real positiu.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">public function store()</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">{</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    request()-&gt;validate(</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    [</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">        &#39;title&#39; =&gt; &#39;required|min:3&#39;,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">        &#39;director&#39; =&gt; &#39;required&#39;,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">        &#39;year&#39; =&gt; &#39;required|numeric|min:1900&#39;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    ]</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">);</span>
<span class="linenos" data-linenos="10 "></span><span class="x">// ... Código para procesar el formulario</span>
<span class="linenos" data-linenos="11 "></span><span class="x">}</span>
</code></pre></div>
<h3 id="utilitzar-form-requests-per-a-validacions-mes-complexes">Utilitzar form requests per a validacions més complexes<a class="headerlink" href="#utilitzar-form-requests-per-a-validacions-mes-complexes" title="Permanent link">&para;</a></h3>
<p>Si hem de validar uns pocs camps, pot ser adequat cridar al mètode <strong>validate</strong> des del propi mètode del controlador, però per a formularis més grans el codi pot créixer massa.
Una alternativa que ofereix laravel és crear un <strong>form request</strong>, una classe addicional que conté la lògica de validació d'una petició. Es creen amb el comando php artisan , i l'opció make:request ,seguida del nom de la classe a crear:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">php artisan make:request MoviePost</span>
</code></pre></div>
<p>Aquesta classe s'emmagatzema per defecte en <strong>app/Http/Requests</strong> , i conté un parell de mètodes predefinits:
<strong>authorize</strong> : retorna un booleà depenent de si l'usuari actual està autoritzat a enviar la petició o no. Per a molts formularis que no requerisquen autorització prèvia podem simplement retornar <strong>true</strong> . Serà el que farem de moment en aquest formulari.
<strong>rules</strong> : aquest és el mètode que més ens interessa. Retorna un array de regles de validació com les que teníem en el controller, així que movem aqueix codi ací:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function rules()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">return [</span>
<span class="linenos" data-linenos="4 "></span><span class="x">    &#39;title&#39; =&gt; &#39;required|min:3&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    &#39;director&#39; =&gt; &#39;required&#39;,</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    &#39;year&#39; =&gt; &#39;required|numeric|min:1900&#39;</span>
<span class="linenos" data-linenos="7 "></span><span class="x">];</span>
<span class="linenos" data-linenos="8 "></span><span class="x">}</span>
</code></pre></div>
<p>Ara, en el mètode del controlador simplement hem d'injectar aquest form request com a paràmetre (si observem la classe que s'ha creat, és un subtipus de Request ), i usar-lo per a validar. La validació és automàtica, és a dir, no hem d'afegir més codi al controlador que l'objecte injectat com a paràmetre,
que s'encarregarà de validar la pròpia petició que conté a través del mètode rules .</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function store(MoviePost $request)</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">// Si entramos aquí, el formulario es válido</span>
<span class="linenos" data-linenos="4 "></span><span class="x">}</span>
</code></pre></div>
<h4 id="mostrar-missatges-derror">Mostrar missatges derror<a class="headerlink" href="#mostrar-missatges-derror" title="Permanent link">&para;</a></h4>
<p>Si la validació és correcta, es retornarà la dada del final de la funció, però si falla algun camp, es tornarà a la pàgina del formulari, amb la informació de l'error que s'haja produït. Podem accedir des de qualsevol
lloc de Laravel a la variable \$errors amb els errors que s'hagen produït en una
operació determinada. Aquesta variable té un mètode booleà anomenat <strong>any</strong> que comprova si hi ha algun error, i un altre mètode anomenat <strong>all</strong> que retorna el array d'errors produïts. Combinant aquests dos mètodes amb Blade, podem mostrar el llistat d'errors de validació abans del formulari, d'aquesta manera:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">@if ($errors-&gt;any())</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    &lt;ul&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">        @foreach($errors-&gt;all() as $error)</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">            &lt;li&gt;{{ $error }}&lt;/li&gt;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">        @endforeach</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    &lt;/ul&gt;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">@endif</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">&lt;form ...&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    @csrf</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    ...</span>
<span class="linenos" data-linenos="11 "></span><span class="x">&lt;/form&gt;</span>
</code></pre></div>
<p>També podem emprar el mètode first del array d'errors per a obtindre el primer error associat a un camp, i mostrar-lo baix o sobre el camp en qüestió. Per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">&lt;form action=&quot;{{ route(&#39;movies.store&#39;) }}&quot; method=&quot;POST&quot;&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    @csrf</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">        &lt;label for=&quot;titulo&quot;&gt;Título:&lt;/label&gt;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; name=&quot;titulo&quot;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">id=&quot;titulo&quot;&gt;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">        @if ($errors-&gt;has(&#39;titulo&#39;))</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">            &lt;div class=&quot;text-danger&quot;&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">                {{ $errors-&gt;first(&#39;titulo&#39;) }}</span>
<span class="linenos" data-linenos="10 "></span><span class="x">            &lt;/div&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="x">        @endif</span>
<span class="linenos" data-linenos="12 "></span><span class="x">    &lt;/div&gt;</span>
<span class="linenos" data-linenos="13 "></span><span class="x">...</span>
</code></pre></div>
<p>A més, podem personalitzar el missatge d'error a mostrar, redefinint en la classe del <em>form request el mètode </em><em>messages</em>* . En aquest mètode retornem un array amb el missatge a mostrar per a cada possible error de validació. Per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">public function messages()</span>
<span class="linenos" data-linenos="2 "></span><span class="x">{</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    return [</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        &#39;titulo.required&#39; =&gt; &#39;El título es obligatorio&#39;,</span>
<span class="linenos" data-linenos="5 "></span><span class="x">        ...</span>
<span class="linenos" data-linenos="6 "></span><span class="x">    ];</span>
<span class="linenos" data-linenos="7 "></span><span class="x">}</span>
</code></pre></div>
<p>De manera alternativa, si optem per validar el formulari en el propi controlador, aquest array de missatges
és passa com a segon paràmetre en l'anomenada al mètode <strong>validate</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">request()-&gt;validate(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">[</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    &#39;title&#39; =&gt; &#39;required|min:3&#39;,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    &#39;director&#39; =&gt; &#39;required&#39;,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    &#39;year&#39; =&gt; &#39;required|numeric|min:1900&#39;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">], [</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    &#39;titulo.required&#39; =&gt; &#39;El título es obligatorio&#39;,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    ...</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">]</span>
<span class="linenos" data-linenos="10 "></span><span class="x">);</span>
</code></pre></div>
<h4 id="recordar-valors-enviats">Recordar valors enviats<a class="headerlink" href="#recordar-valors-enviats" title="Permanent link">&para;</a></h4>
<p>Un problema derivat de la validació de dades és que, en tornar a la pàgina del formulari després d'un error, els camps que ja s'han examinat fins a l'error, encara que foren correctes, han perdut el valor que tenien, i pot resultar enutjós haver-los de que emplenar una altra vegada. Per a mantindre el seu antic valor, podem afegir l'atribut <strong>value</strong> en cada camp del formulari, i utilitzar amb Blade una funció anomenada <strong>old</strong> , que permet accedir a l'anterior valor d'un determinat camp, referenciat pel seu nom:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>&lt;form action=&quot;{{ route(&#39;movies.store&#39;) }}&quot; method=&quot;POST&quot;&gt;
<span class="linenos" data-linenos=" 2 "></span>    @csrf
<span class="linenos" data-linenos=" 3 "></span>    &lt;div class=&quot;form-group&quot;&gt;
<span class="linenos" data-linenos=" 4 "></span>        &lt;label for=&quot;titulo&quot;&gt;Título:&lt;/label&gt;
<span class="linenos" data-linenos=" 5 "></span>        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; name=&quot;titulo&quot;
<span class="linenos" data-linenos=" 6 "></span>            id=&quot;titulo&quot; value=&quot;{!! old(&#39;titulo&#39;) !!}&quot;&gt;
<span class="linenos" data-linenos=" 7 "></span>        @if ($errors-&gt;has(&#39;titulo&#39;))
<span class="linenos" data-linenos=" 8 "></span>            &lt;div class=&quot;text-danger&quot;&gt;
<span class="linenos" data-linenos=" 9 "></span>                {{ $errors-&gt;first(&#39;titulo&#39;) }}
<span class="linenos" data-linenos="10 "></span>            &lt;/div&gt;
<span class="linenos" data-linenos="11 "></span>        @endif
<span class="linenos" data-linenos="12 "></span>    &lt;/div&gt;
<span class="linenos" data-linenos="13 "></span>...
</code></pre></div>
<h2 id="casos-especials">Casos especials<a class="headerlink" href="#casos-especials" title="Permanent link">&para;</a></h2>
<h4 id="obtenir-dades-agrupades">Obtenir dades agrupades<a class="headerlink" href="#obtenir-dades-agrupades" title="Permanent link">&para;</a></h4>
<p>O també podem obtenir totes les dades d'entrada alhora (en un array) o solament alguns d'ells:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">    // Obtenir tots:</span>
<span class="linenos" data-linenos="2 "></span><span class="x">        $input = $request-&gt;all();</span>
<span class="linenos" data-linenos="3 "></span><span class="x">    // Obtenir solament els camps indicats:</span>
<span class="linenos" data-linenos="4 "></span><span class="x">        $input = $request-&gt;only(&#39;username&#39;, &#39;password&#39;);</span>
<span class="linenos" data-linenos="5 "></span><span class="x">    // Obtenir tots excepte els indicats: </span>
<span class="linenos" data-linenos="6 "></span><span class="x">        $input = $request-&gt;except(&#39;credit_card&#39;);</span>
</code></pre></div>
<h4 id="assignacio-massiva">Assignació Massiva<a class="headerlink" href="#assignacio-massiva" title="Permanent link">&para;</a></h4>
<p>També es pot utilitzar el mètode <strong>create</strong> per a emmagatzemar un model en una única línia. Des del mètode es retornarà la instància del model inserit. No obstant açò, abans d'açò, cal especificar la propietat <strong>fillable</strong> o <strong>guarded</strong> del model, doncs tots els models Eloquent posseeixen protecció contra l'assignació en massa.</p>
<p>Una vulnerabilitat d'assignació massiva té lloc quan un usuari passa un paràmetre HTTP inesperat a través de la sol·licitud, i aquest paràmetre canvia una columna de la base de dades que no s'esperava. Per exemple, un usuari malintencionat podria enviar un paràmetre <strong>is_admin</strong> a través d'una petició HTTP, el qual es marejaria dins del mètode <strong>create</strong> del model, permetent a l'usuari postular-se com un administrador.</p>
<p>Així que, per a començar, cal definir a quins atributs se'ls permet l'assignació massiva. Açò s'estableix en la propietat <strong>fillable</strong> del model. Per exemple, anem a permetre l'assignació massiva sobre l'atribut <strong>name</strong> d'un model Flight:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>&lt;?php
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>namespace App;
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>use Illuminate\Database\Eloquent\Model;
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>class Flight extends Model
<span class="linenos" data-linenos=" 8 "></span>{
<span class="linenos" data-linenos=" 9 "></span>    /**
<span class="linenos" data-linenos="10 "></span>     * The attributes that are mass assignable.
<span class="linenos" data-linenos="11 "></span>     *
<span class="linenos" data-linenos="12 "></span>     * @var array
<span class="linenos" data-linenos="13 "></span>     */
<span class="linenos" data-linenos="14 "></span>    protected $fillable = [&#39;name&#39;];
<span class="linenos" data-linenos="15 "></span>}
</code></pre></div>
<h5 id="atributes-guarding">Atributes Guarding<a class="headerlink" href="#atributes-guarding" title="Permanent link">&para;</a></h5>
<p>Mentre que \$fillable serveix com una "llista blanca" d'atributs que poden ser assignats massivament, també es pot optar per \$guarded. La propietat guarded conté un array d'atributs que no poden ser assignats de forma massiva. 
La resta d'atributs que no es troben en el array si podran. Pel que, \$guarded actua com una "llista negra". Per descomptat, s'ha d'establir \$fillable o \$guarded - mai tots dos. En l'exemple que segueix, tots els atributs excepte <strong>price</strong> comptaran amb assignació massiva:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>&lt;?php
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>namespace App;
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>use Illuminate\Database\Eloquent\Model;
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>class Flight extends Model
<span class="linenos" data-linenos=" 8 "></span>{
<span class="linenos" data-linenos=" 9 "></span>    /**
<span class="linenos" data-linenos="10 "></span>     * The attributes that aren&#39;t mass assignable.
<span class="linenos" data-linenos="11 "></span>     *
<span class="linenos" data-linenos="12 "></span>     * @var array
<span class="linenos" data-linenos="13 "></span>     */
<span class="linenos" data-linenos="14 "></span>    protected $guarded = [&#39;price&#39;];
<span class="linenos" data-linenos="15 "></span>}
</code></pre></div>
<p>Si es desitja que tots els atributs es puguen assignar en massa, es pot definir la propietat $guarded com un array buit:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>/*
<span class="linenos" data-linenos="2 "></span>* The attributes that llauren&#39;t mass assignable.
<span class="linenos" data-linenos="3 "></span>*
<span class="linenos" data-linenos="4 "></span>* @var array
<span class="linenos" data-linenos="5 "></span>/
<span class="linenos" data-linenos="6 "></span>protected $guarded = [];
</code></pre></div>
<h4 id="fitxers-dentrada">Fitxers d'entrada<a class="headerlink" href="#fitxers-dentrada" title="Permanent link">&para;</a></h4>
<p>Laravel facilita una sèrie de classes per a treballar amb els fitxers d'entrada. Per exemple per a obtenir un fitxer que s'ha enviat en el camp amb nom photo i guardar-ho en una variable, hem de fer:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>$file = $request-&gt;file(&#39;photo&#39;);
<span class="linenos" data-linenos="2 "></span>// O simplement... 
<span class="linenos" data-linenos="3 "></span>$file = $request-&gt;photo;
</code></pre></div>
<p>Si volem podem comprovar si un determinat camp té un fitxer assignat:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>if ($request-&gt;hasFile(&#39;photo&#39;)) { //...}
</code></pre></div>
<p>El Symfony\Component\HttpFoundation\File\UploadedFile estén de la classe de PHP <a href="http://php.net/manual/es/class.splfileinfo.php">SplFileInfo</a>, per tant, tindrem molts mètodes que podem utilitzar per a obtenir dades del fitxer o per a gestionar-ho.</p>
<p>Per exemple, per a comprovar si el fitxer que s'ha pujat és vàlid:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>if ($request-&gt;file(&#39;photo&#39;)-&gt;isValid()) { //...}
</code></pre></div>
<p>O per a moure el fitxer d'entrada a una ruta determinada: </p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>// Moure el fitxer a la ruta conservant el nom original
<span class="linenos" data-linenos="2 "></span>    $request-&gt;file(&#39;photo&#39;)-&gt;move($destinationPath);
<span class="linenos" data-linenos="3 "></span>// Moure el fitxer a la ruta amb un nou nom: 
<span class="linenos" data-linenos="4 "></span>    $request-&gt;file(&#39;photo&#39;)-&gt;move($destinationPath, $fileName);
</code></pre></div>
<p>Laravel incorpora una llibreria que ens permet gestionar l'accés i escriptura de fitxers en un <a href="https://laravel.com/docs/8.x/filesystem">emmagatzematge</a>. L'interessant d'açò és que ens permet manejar de la mateixa forma l'emmagatzematge en local, en Amazon S3 i en Rackspace Cloud Storage, simplement ho hem de configurar en config/filesystems.php i posteriorment els podrem usar de la mateixa forma. </p>
<p>Per exemple, per a emmagatzemar un fitxer pujat mitjançant un formulari hem d'usar el mètode store indicant com a paràmetre la ruta on volem emmagatzemar el fitxer (sense el nom del fitxer):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="x">$path = $request-&gt;photo-&gt;store(&#39;images&#39;);</span>
<span class="linenos" data-linenos="2 "></span><span class="x">$path = $request-&gt;photo-&gt;store(&#39;images&#39;, &#39;s3&#39;); // Especificar un emmagatzematge</span>
</code></pre></div>
<p>Aquests mètodes retornaran el path fins al fitxer emmagatzemat de forma relativa a l'arrel de disc configurada. Per al nom del fitxer es generarà automàticament un UUID (identificador únic universal). Si volem especificar nosaltres el nom hauríem d'usar el mètode storeAs:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>$path = $request-&gt;photo-&gt;storeAs(&#39;images&#39;, &#39;filename.jpg&#39;); 
<span class="linenos" data-linenos="2 "></span>$path = $request-&gt;photo-&gt;storeAs(&#39;images&#39;, &#39;filename.jpg&#39;, &#39;s3&#39;);
</code></pre></div>
<p>Altres mètodes que podem utilitzar per a recuperar informació del fitxer són:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="x">    // Obtenir la ruta:</span>
<span class="linenos" data-linenos=" 2 "></span><span class="x">    $path = $request-&gt;file(&#39;photo&#39;)-&gt;getRealPath();</span>
<span class="linenos" data-linenos=" 3 "></span><span class="x">    // Obtenir el nom original:</span>
<span class="linenos" data-linenos=" 4 "></span><span class="x">    $name = $request-&gt;file(&#39;photo&#39;)-&gt;getClientOriginalName();</span>
<span class="linenos" data-linenos=" 5 "></span><span class="x">    // Obtenir l&#39;extensió:</span>
<span class="linenos" data-linenos=" 6 "></span><span class="x">    $extension = $request-&gt;file(&#39;photo&#39;)-&gt;getClientOriginalExtension();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="x">    // Obtenir la grandària:</span>
<span class="linenos" data-linenos=" 8 "></span><span class="x">    $size = $request-&gt;file(&#39;photo&#39;)-&gt;getSize();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="x">    // Obtenir el Type:</span>
<span class="linenos" data-linenos="10 "></span><span class="x">    $acarone = $request-&gt;file(&#39;photo&#39;)-&gt;getMimeType();</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2024 Xavier Sastre - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "content.tabs.link", "navigation.expand"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copiat al porta-retalls", "clipboard.copy": "C\u00f2pia al porta-retalls", "search.result.more.one": "1 m\u00e9s en aquesta p\u00e0gina", "search.result.more.other": "# m\u00e9s en aquesta p\u00e0gina", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.term.missing": "Desaparegut", "select.version": "Selecciona la versi\u00f3"}}</script>
    
    
      <script src="assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>