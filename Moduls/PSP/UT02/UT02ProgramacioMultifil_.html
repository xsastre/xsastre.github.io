
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docencia.xaviersastre.cat/Moduls/PSP/UT02/UT02ProgramacioMultifil_.html">
      
      
      
      
      <link rel="icon" href="../../../imatges/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.38">
    
    
      
        <title>UT02ProgramacioMultifil - Docencia Xavier</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KXJX1CP7QG"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KXJX1CP7QG",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KXJX1CP7QG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fundamentos-de-la-programacion-multihilo" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Capçalera">
    <a href="../../../index.html" title="Docencia Xavier" class="md-header__button md-logo" aria-label="Docencia Xavier" data-md-component="logo">
      
  <img src="../../../imatges/education_blanc.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docencia Xavier
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UT02ProgramacioMultifil 
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="Teal"  aria-label="Canviar a mode nit"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Canviar a mode nit" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="Teal"  aria-label="Canviar a mode dia"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Canviar a mode dia" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Neteja" aria-label="Neteja" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicialitzant cerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegació" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="Docencia Xavier" class="md-nav__button md-logo" aria-label="Docencia Xavier" data-md-component="logo">
      
  <img src="../../../imatges/education_blanc.png" alt="logo">

    </a>
    Docencia Xavier
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inici
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DWES
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            DWES
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/UT02PHP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT02 Llenguatge PHP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/UT03PHPPOO.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT03 PHP POO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/UT05AccesADades.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT05 Accés a dades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/UT05AccesADadesAmbMySQL.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT05 Accés a dades amb MySQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exercicis i solucions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Exercicis i solucions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/exercicisisolucions/Exercicis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercicis PHP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/exercicisisolucions/ExercicisPOO.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercicis PHP POO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/exercicisisolucions/ExerciciGestioBotiga.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercici PHP Gestió Botiga
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWES/exercicisisolucions/ExpressionsRegularsPHP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Expressions Regulars PHP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DWEC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            DWEC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/_DWEC2425.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desenvolupament web en entorn client - DAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/desenvolupamentfrontend.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desenvolupamet frontend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/UT03Diapositives.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diapositives UT03
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/UT03_Treball_amb_matrius.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT03 - Treball amb matrius
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/UT03FuncionsJavascript.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT03 - Funcions a JavaScript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exercicis i solucions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Exercicis i solucions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/exercicisisolucions/Exercicis_UT02.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercicis UT02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/exercicisisolucions/Exercicis_UT03.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercicis UT03
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DWEC/exercicisisolucions/Exercici_UT03_funcio_reduce.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercici UT03 - Interpretació codi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PSP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            PSP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Continguts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Continguts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_PSP2425.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Codis exemple multifil
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="filosofs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Problema del sopar dels filòsofs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="UT02Continguts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continguts UT02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Problemadeljardi.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Problema del jardí
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exercicisisolucions/ExercicisFils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercicis Multifil
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AW
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            AW
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/00.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temporització aproximada
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/01.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT01 Aplicacions web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/02.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT02 HTML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/03CSS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UT03 CSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exercicis i solucions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Exercicis i solucions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/exercicisisolucions/solucio_formulari1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solució Formulari 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/exercicisisolucions/practica_html_W3Schools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tasca HTML w3schools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/exercicisisolucions/practica_html_freeCodeCamp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pràctica HTML freeCodeCamp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/exercicisisolucions/practica_CSS_W3Schools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pràctica CSS W3Schools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/exercicisisolucions/ExerciciHTMLCSSRestaurant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercici HTML+CSS Restaurant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AW/exercicisisolucions/practicaPortafoliHTMLCSS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pràctica avaluable Portafoli HTML+CSS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            SI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SI/_SI2425.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continguts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SI/calculPotenciaSAI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Càlcul potència necessaria per un SAI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SI/practicaPotenciaSAI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pràctica potència SAI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SI/SIUT02UT03.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Treball de classe - Seguretat passiva equips i emmagatz.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AOF
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            AOF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Continguts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Continguts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AOF/UT_organitzacio_treball.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Organització individual de la feina
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AOF/AOFUT2_Presentacions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AOFUT02 - Presentacions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bloc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Arxiva
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Arxiva
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/archive/2024.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/aws.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/amazon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Amazon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/coneixements-generals.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coneixements generals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/dam.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/daw.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/dwec.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DWEC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/dwes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DWES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/dynamodb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/general.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/html.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/js.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/java.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/javascript.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Javascript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/matem%C3%A0tiques.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Matemàtiques
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/php.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/psp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PSP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/programaci%C3%B3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Programació
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/category/programci%C3%B3-multifil.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Programció multifil
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><a href="#fundamentos-de-la-programación-multihilo">Fundamentos de la programación multihilo</a></p>
<p><a href="#programación-secuencial-o-de-único-hilo">Programación secuencial o de único hilo</a></p>
<p><a href="#programación-concurrente-o-multihilo">Programación concurrente o multihilo</a></p>
<h1 id="fundamentos-de-la-programacion-multihilo">Fundamentos de la programación multihilo<a class="headerlink" href="#fundamentos-de-la-programacion-multihilo" title="Permanent link">&para;</a></h1>
<p>En muchas ocasiones las sentencias que forman un programa deben ejecutarse de manera secuencial, ya que, entre todas, forman una lista ordenada de pasos a seguir para resolver un problema. Otras veces, dichos pasos no tienen por qué ser secuenciales, pudiéndose realizar varios a la vez.</p>
<p>Otras veces, disponer de simultaneidad en la ejecución no es opcional, sino necesario, como ocurre en las aplicaciones web. Si no se atendiesen simultáneamente las peticiones que recibe un servidor web, cada usuario debería esperar hasta que todos los usuarios que llegaron antes que él fuesen atendidos para obtener las páginas o recursos solicitados.</p>
<p>En ambos casos, la solución se encuentra en la programación multihilo, una técnica utilizada para conseguir procesamiento simultáneo.</p>
<p>Aunque plena de posibilidades, esta técnica no está exenta de condiciones y restricciones. En esta unidad se presentan las herramientas de procesamiento multihilo disponibles en el lenguaje Java, junto con los aspectos teóricos referentes al análisis de los procesos para determinar si es posible ejecutarlos con múltiples hilos, así como a detectar y prevenir los conflictos que surgen como consecuencia de la programación concurrente.</p>
<p>Desde el punto de vista del sistema operativo, un programa informático en ejecución es un proceso que compite con los demás procesos por acceder a los recursos del sistema. Visto desde dentro, un programa es, básicamente, una sucesión de sentencias que se ejecutan una detrás de otra.</p>
<p>El sistema operativo se encarga de hacer convivir los diferentes procesos y de repartir los recursos entre sí, por lo que cuando se programa no hay que tener en cuenta aspectos relacionados con cómo se van a gestionar los procesos o cómo estos van a tener acceso a los recursos. Salvo el optimizar el uso de memoria y conseguir que los algoritmos sean eficientes, los programadores no tienen que preocuparse del resto: el sistema operativo se encarga de la concurrencia a nivel de proceso.</p>
<p>Es dentro del interior de los procesos donde la programación tiene algo que decir con respecto a la concurrencia, mediante la programación multihilo.</p>
<blockquote>
<p>Un hilo, también conocido como thread, es una pequeña unidad de computación que se ejecuta dentro del contexto de un proceso. Todos los programas utilizan hilos.</p>
</blockquote>
<p>En el caso de un programa absolutamente secuencial, el hilo de ejecución es único, lo que provoca que cada sentencia tenga que esperar que la sentencia inmediatamente anterior se ejecute completamente antes de comenzar su ejecución. Esto no quiere decir en ningún caso que no existan estructuras de control, como <code>if</code> o <code>while</code>, sino que las sentencias se van ejecutando una detrás de otra y no de manera simultánea.</p>
<p>En cambio, en un programa multihilo, algunas de las sentencias se ejecutan simultáneamente, ya que los hilos creados y activos en un momento dado acceden a los recursos de procesamiento sin necesitar esperar a que otras partes del programa terminen.</p>
<p>A continuación, se citan algunas de las características que tienen los hilos:</p>
<ul>
<li><strong>Dependencia del proceso</strong>. No se pueden ejecutar independientemente. Siempre se tienen que ejecutar dentro del contexto de un proceso.</li>
<li><strong>Ligereza</strong>. Al ejecutarse dentro del contexto de un proceso, no requiere generar procesos nuevos, por lo que son óptimos desde el punto de vista del uso de recursos. Se pueden generar gran cantidad de hilos sin que provoquen pérdidas de memoria.</li>
<li><strong>Compartición de recursos</strong>. Dentro del mismo proceso, los hilos comparten espacio de memoria. Esto implica que pueden sufrir colisiones en los accesos a las variables provocando errores de concurrencia.</li>
<li><strong>Paralelismo</strong>. Aprovechan los núcleos del procesador generando un paralelismo real, siempre dentro de las capacidades del procesador.</li>
<li><strong>Concurrencia</strong>. Permiten atender de manera concurrente múltiples peticiones. Esto es especialmente importante en servidores web y de bases de datos, por ejemplo.</li>
</ul>
<p>Para ilustrar de manera más precisa cómo se comporta un programa de un único hilo frente a los programas de múltiples hilos se puede establecer la siguiente analogía.</p>
<p><em>El camarero de una cafetería recibe a un cliente que le pide un café, una tostada y una tortilla francesa. Si el camarero trabaja como un proceso de un único hilo pondrá la cafetera a preparar el café, esperará a que termine para poner el pan a tostar y no pedirá la tortilla a la cocina hasta que el pan no esté tostado. Probablemente, cuando todo esté dispuesto para servir, el café y la tostada estarán fríos y el cliente aburrido de esperar.</em></p>
<p><em>Los camareros (la gran mayoría de ellos) suelen trabajar como procesos multihilo: ponen la cafetera a preparar el café, el pan a tostar y piden a la cocina los platos sin esperar a que cada una de las demás tareas esté terminada. Dado que cada una de ellas consume diferentes recursos, no es necesario hacerlo. Transcurrido el tiempo que tarda en estar lista la tarea más lenta, el cliente estará atendido.</em></p>
<p><em>Siguiendo con la analogía, al igual que pasa en los ordenadores, los recursos de una cafetería son limitados, por lo que hay una restricción física que impide que se hagan más tareas simultáneamente de las que permiten los recursos. Si solo hay una tostadora con capacidad para dos rebanadas de pan no se podrán tostar más de dicho número en un mismo instante de tiempo.</em></p>
<p>La programación que permite realizar este tipo de sistemas se llama multihilo, concurrente o asíncrona.</p>
<h2 id="programacion-secuencial-o-de-unico-hilo">Programación secuencial o de único hilo<a class="headerlink" href="#programacion-secuencial-o-de-unico-hilo" title="Permanent link">&para;</a></h2>
<p>El siguiente ejemplo programado en Java ilustra cómo se comporta un programa que se ejecuta en un único hilo, así como las consecuencias que esto implica. El programa está compuesto por una única clase (representa un ratón) compuesta por dos atributos: el nombre y el tiempo en segundos que tarda en comer. En el método main se instancian varios objetos (ratones) y se invoca al método comer de cada uno de ellos. Este método muestra un texto por pantalla cuando comienza, realiza una pausa de la duración en se- gundos (con el método sleep de la clase Thread) que indica el parámetro tiempoAlimentacion y, finalmente, muestra otro texto por pantalla cuando finaliza.</p>
<p>Consulta el <a href="#Ejemplo01">Ejemplo01</a></p>
<h2 id="programacion-concurrente-o-multihilo">Programación concurrente o multihilo<a class="headerlink" href="#programacion-concurrente-o-multihilo" title="Permanent link">&para;</a></h2>
<p>El ejemplo anterior se puede programar de manera concurrente de forma sencilla, ya que no hay ningún recurso compartido. Para ello, basta con convertir cada objeto de la clase Raton en un hilo (thread) y programar aquello que se quiere que ocurra concurrentemente dentro del método run. Una vez creadas las instancias, se invoca al método start de cada una de ellas, lo que provoca la ejecución del contenido del método run en un hilo independiente.</p>
<p>Consulta el <a href="#Ejemplo02">Ejemplo02</a></p>
<p>En Java existen dos formas para la creación de hilos:</p>
<ul>
<li>Implementando la interface <code>java.lang.Runnable</code>.</li>
<li>Heredando de la clase <code>java.lang.Thread</code>.</li>
</ul>
<p>La implementación de la interface <code>Runnable</code> obliga a programar el método sin argumentos <code>run</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ThreadViaInterface</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="nd">@override</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="5 "></span><span class="p">}</span>
</code></pre></div>
<p>Heredando de la clase Thread esto no es obligatorio porque dicha clase ya es una implementación de la interface Runnable.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ThreadViaInheritance</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="p">}</span>
</code></pre></div>
<p>No obstante, crear un hilo heredando de <code>Thread</code> «necesita» la implementación del método sin argumentos <code>run</code>, ya que de lo contrario la clase no tendrá un comportamiento multihilo.</p>
<p>Consulta el <a href="#Ejemplo03">Ejemplo3</a></p>
<blockquote>
<p>Es habitual que, en las primeras tomas de contacto con los hilos en Java, los programadores intenten ejecutar el método <code>run</code> en lugar de ejecutar el método <code>start</code>. Desde el punto de vista de la compilación no habrá problema: el programa se compilará sin errores.</p>
<p><strong>Desde la perspectiva de la programación concurrente el resultado no será el adecuado, ya que los hilos se ejecutarán uno detrás de otro, de manera secuencial, no obteniendo ninguna mejora frente a la programación secuencial convencional.</strong></p>
</blockquote>
<p>La creación de threads mediante la implementación de la interface <code>Runnable</code> tiene una ventaja clara sobre la herencia de la clase <code>Thread</code>: al ser Java un lenguaje que no admite herencia múltiple, heredar de dicha clase impide otro tipo de herencias, limitando las posibilidades de diseño del software.</p>
<p>Por otra parte, a través de la implementación mediante la interface <code>Runnable</code> se pueden lanzar muchos hilos de ejecución sobre un único objeto, frente a la herencia de <code>Thread</code> que creará un objeto por cada hilo.</p>
<p>En el siguiente ejemplo se implementa un hilo mediante la interface <code>Runnable</code> para crear múltiples hilos a partir de un único objeto. En el hilo, un atributo de instancia llamado <code>alimentoConsumido</code> se incrementa en 1 durante la ejecución del método <code>comer</code>, invocado en el método <code>run</code>. Se puede observar en el método <code>main</code> cómo se crea una única instancia de la clase <code>RatonSimple</code> y se crean cuatro hilos que la ejecutan.</p>
<p>Consulta el <a href="#Ejemplo04">Ejemplo04</a> y <a href="#Ejemplo04bis">Ejemplo04bis</a></p>
<blockquote>
<p>Debido a la naturaleza de la programación multihilo, las salidas de las ejecuciones de los programas de ejemplo pueden no coincidir con las presentadas en los apuntes. De hecho, en distintas ejecuciones en la misma máquina los resultados pueden variar.</p>
</blockquote>
<h2 id="estados-de-los-hilos">Estados de los hilos<a class="headerlink" href="#estados-de-los-hilos" title="Permanent link">&para;</a></h2>
<p>Durante el ciclo de vida de los hilos, estos pasan por diversos estados. En Java, están recogidos dentro de la enumeración <code>State</code> contenida dentro de la clase <code>java.lang.Thread</code>.</p>
<p>El estado de un hilo se obtiene mediante el método <code>getState()</code> de la clase <code>Thread</code>, que devolverá algunos de los valores posibles recogidos en la enumeración indicada anteriormente.</p>
<p>Los estados de un thread son los que se muestran en la siguiente tabla:</p>
<table>
<thead>
<tr>
<th>Estado</th>
<th>Valor en <code>Thread.State</code></th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nuevo</strong></td>
<td><code>NEW</code></td>
<td>El hilo está creado, pero aún no se ha arrancado.</td>
</tr>
<tr>
<td><strong>Ejecutado</strong></td>
<td><code>RUNNABLE</code></td>
<td>El hilo está arrancado y podría estar en ejecución o pendiente de ejecución.</td>
</tr>
<tr>
<td><strong>Bloqueado</strong></td>
<td><code>BLOCKED</code></td>
<td>Bloqueado por un monitor.</td>
</tr>
<tr>
<td><strong>Esperando</strong></td>
<td><code>WAITING</code></td>
<td>El hilo está esperando a que otro hilo realice una acción determinada.</td>
</tr>
<tr>
<td><strong>Esperando un tiempo</strong></td>
<td><code>TIME_WAITING</code></td>
<td>El hilo está esperando a que otro hilo realice una acción determinada en un período de tiempo concreto.</td>
</tr>
<tr>
<td><strong>Finalizado</strong></td>
<td><code>TERMINATED</code></td>
<td>El hilo ha terminado su ejecución.</td>
</tr>
</tbody>
</table>
<p>En el siguiente código de ejemplo, se almacenan en un <code>ArrayList</code> los estados por los que pasa un hilo que contiene en su interior una llamada al método <code>sleep</code>. Se utiliza la clase <code>RatonSimple</code> que implementa <code>Runnable</code> de los ejemplos anteriores.</p>
<p>Consulta el <a href="#Ejemplo05">Ejemplo05</a></p>
<blockquote>
<p>Todos los hilos pasan por los estados <strong>NEW</strong>, <strong>RUNNABLE</strong> y <strong>TERMINATED</strong>. El resto de los estados están condicionados a circunstancias propias de la ejecución.</p>
</blockquote>
<h2 id="introduccion-a-los-problemas-de-concurrencia">Introducción a los problemas de concurrencia<a class="headerlink" href="#introduccion-a-los-problemas-de-concurrencia" title="Permanent link">&para;</a></h2>
<p>En programación concurrente las dificultades aparecen cuando los distintos hilos acceden a un recurso compartido y limitado. Si en el ejemplo de los ratones (el físico, no el programático), estos comiesen a través de un dispositivo al que solo pudiesen acceder de uno en uno, la concurrencia sería imposible. En el ejemplo programático el problema es el mismo, pero no existe la restricción física, por lo que nada impide que los hilos accedan al recurso compartido y es en ese momento donde aparecerán los problemas.</p>
<p>El acceso a los recursos compartidos limitados, por lo tanto, se debe gestionar correctamente. Por suerte, existen técnicas, clases y librerías que implementan soluciones, por lo que únicamente hay que conocerlas y saberlas utilizar en el momento adecuado.</p>
<p>Un aspecto importante referente a los problemas de concurrencia es que no siempre provocan un error en tiempo de ejecución. Esto significa que en sucesivas ejecuciones del programa multihilo el error se producirá en algunas de ellas y en otras no. Frente al determinismo de los programas secuenciales (los mismos datos de entrada generan siempre las mismas salidas), en el entorno multihilo los factores que determinan las condiciones de ejecución pueden tener su origen en elementos sobre los que el programador no tiene capacidad de influir, como el sistema operativo.</p>
<p>La dificultad, en este tipo de programación, reside en el hecho de que el programador tiene que saber de forma anticipada que el error se puede producir en una sentencia o bloque de sentencias, por cómo esta se ejecuta y qué recursos utiliza. No basta simplemente con realizar pruebas convencionales para determinar que el algoritmo está bien programado. Además, hay que «saber» que está bien programado.</p>
<p>Como se ha indicado anteriormente existen soluciones para todos los problemas, pero en esta afirmación hay una verdad a medias. Los problemas de la programación concurrente se resuelven, en ciertos casos, convirtiendo en secuenciales determinadas partes del código. Si no se programa correctamente, se corre el riesgo de convertir todo el programa en secuencial lo que evitaría, efectivamente, los problemas de concurrencia ya que esta habría dejado de existir.</p>
<h1 id="programacion-multihilo-clases-y-librerias">Programación multihilo: clases y librerías<a class="headerlink" href="#programacion-multihilo-clases-y-librerias" title="Permanent link">&para;</a></h1>
<h2 id="paquete-javalang">Paquete <code>java.lang</code><a class="headerlink" href="#paquete-javalang" title="Permanent link">&para;</a></h2>
<p>Java dispone de un importante número de clases destinadas a la programación multihilo. Estas clases tienen múltiples aplicaciones, desde la propia construcción de los hilos hasta dar soporte a estructuras de datos consistentes cuando varios hilos acceden a ellas.</p>
<p>Estas clases se encuentran agrupadas en dos paquetes principales: el paquete <code>java.lang</code> y el paquete <code>java.util.concurrent</code>.</p>
<p>El paquete <code>java.lang</code> es un paquete importado por defecto en Java (contiene las clases básicas, incluida <code>Object</code> como clase raíz de la jerarquía de clases del lenguaje) por lo que no hay que importar ninguna librería para utilizar sus clases.</p>
<p>Dentro de este paquete se encuentran la interfaz <code>Runnable</code> y la clase <code>Thread</code>, como elementos fundamentales para la construcción de hilos. También se encuentran las clases <code>Timer</code> y <code>TimerTask</code></p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Runnable</code></td>
<td>Interface</td>
<td>Esta interface debe implementarse por aquellas clases que se quieran ejecutar como un <code>thread</code>. Define un método sin argumentos <code>run</code>.</td>
</tr>
<tr>
<td><code>Thread</code></td>
<td>Clase</td>
<td>Esta clase implementa la interface <code>Runnable</code>, siendo un hilo en sí misma. Una clase que hereda de <code>Thread</code> y que sobrescribe el método <code>run</code> se ejecuta de manera concurrente si se invoca al método <code>start</code>.<br />Con la clase <code>Thread</code> se puede envolver un objeto que implemente <code>Runnable</code> provocando que se ejecute en un hilo independiente.</td>
</tr>
<tr>
<td><code>Timer</code></td>
<td>Clase</td>
<td>Permite la programación de la ejecución de tareas en diferido y de forma repetitiva mediante el método <code>schedule</code>. Este método espera tareas programables, representadas por objetos de la clase <code>TimerTask</code>, así como información del momento de inicio de la tarea y del tiempo que debe transcurrir entre cada una de las ejecuciones de la misma.</td>
</tr>
<tr>
<td><code>TimerTask</code></td>
<td>Clase abstracta</td>
<td>Heredando de esta clase y sobrescribiendo el método <code>run</code> se puede crear una tarea programable con la clase <code>Timer</code>.</td>
</tr>
</tbody>
</table>
<p>Consulta el <a href="#Ejemplo06">Ejemplo06</a></p>
<h2 id="paquete-javautilconcurrent">Paquete <code>java.util.concurrent</code><a class="headerlink" href="#paquete-javautilconcurrent" title="Permanent link">&para;</a></h2>
<p>En este paquete se incluyen un interesante conjunto de clases y herramientas relacionadas con la programación concurrente. A continuación, se muestran algunos de los elementos más relevantes del mismo.</p>
<h3 id="executor">Executor<a class="headerlink" href="#executor" title="Permanent link">&para;</a></h3>
<p>Es una interface para la definición de sistemas multihilo. Permite ejecutar tareas de tipo <code>Runnable</code>. Algunas de sus interfaces derivadas, así como clases directamente relaciona das se muestran en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ExecutorService</code></td>
<td>Interface</td>
<td>Subinterface de Executor, permite gestionar tareas asíncronas</td>
</tr>
<tr>
<td><code>SchedulledExecutorService</code></td>
<td>Interface</td>
<td>Permite la planificación de la ejecución de tareas asíncronas.</td>
</tr>
<tr>
<td><code>Executors</code></td>
<td>Clase</td>
<td>Fábrica de objetos <code>Executor</code>, <code>ExecutorServices</code>, <code>ThreadFactory</code> y <code>Callable</code>.</td>
</tr>
<tr>
<td><code>TimeUnit</code></td>
<td>Enumeración</td>
<td>Proporciona representaciones de unidades de tiempo con distinta granularidad, desde días hasta nanosegundos.</td>
</tr>
</tbody>
</table>
<p>Consulta el <a href="#Ejemplo07">Ejemplo07</a></p>
<h2 id="queues">Queues<a class="headerlink" href="#queues" title="Permanent link">&para;</a></h2>
<p>Java proporciona componentes que resuelven todo el espectro de necesidades relacionado con las colas para crear entornos seguros de ejecución de soluciones de mensajería, gestión de colas de trabajo y sistemas basados en esquemas productor-consumidor en entornos concurrentes.</p>
<p>Las clases más relevantes de este grupo se recogen en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ConcurrentLinkedQueue</code></td>
<td>Clase</td>
<td>Una cola enlazada resistente a hilos.</td>
</tr>
<tr>
<td><code>ConcurrentLinkedDeque</code></td>
<td>Clase</td>
<td>Una cola doblemente enlazada resistente a hilos.</td>
</tr>
<tr>
<td><code>BlockingQueue</code></td>
<td>Interface</td>
<td>Una cola que incluye bloqueos de espera para la gestión del espacio. Algunas de sus implementaciones son <code>LinkedBlockingQueue</code>, <code>ArrayBlockingQueue</code>, <code>SynchronousQueue</code>, <code>PriorityBlockingQueue</code> y <code>DelayQueue</code>.</td>
</tr>
<tr>
<td><code>TransferQueue</code></td>
<td>Interface</td>
<td>Un tipo de <code>BlockingQueue</code> especialmente diseñado para mensajería.</td>
</tr>
<tr>
<td><code>BlockingDeque</code></td>
<td>Interface</td>
<td>Una cola doblemente enlazada que incluye bloqueos de espera para la gestión del espacio. Dispone de una implementación en la clase <code>LinkedBlockingDeque</code>.</td>
</tr>
</tbody>
</table>
<p>Consulta el <a href="#Ejemplo08">Ejemplo08</a> y <a href="#Ejemplo08bis">Ejemplo08bis</a></p>
<h2 id="sincronizadores">Sincronizadores<a class="headerlink" href="#sincronizadores" title="Permanent link">&para;</a></h2>
<p>El paquete <code>java.util.concurrent</code> proporciona cinco clases específicas para conseguir que la concurrencia entre hilos se desarrolle de manera correcta. Estas clases son las que se recogen en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Semaphore</code></td>
<td>Clase</td>
<td>Proporciona el mecanismo clásico para regular el acceso de los a recursos de uso limitado.</td>
</tr>
<tr>
<td><code>CountDownLatch</code></td>
<td>Clase</td>
<td>Proporciona una ayuda para la sincronización cuando los hilos deben esperar hasta que se realicen un conjunto de operaciones.</td>
</tr>
<tr>
<td><code>CyclingBarrier</code></td>
<td>Clase</td>
<td>Proporciona una ayuda para la sincronización cuando unos hilos deben esperar hasta que otros hilos alcancen un punto de ejecución determinado.</td>
</tr>
<tr>
<td><code>Phaser</code></td>
<td>Clase</td>
<td>Proporcionauna funcionalidad similar a <code>CountDownLatch</code> y a <code>CyclingBarrier</code> a través de un uso más flexible.</td>
</tr>
<tr>
<td><code>Exchanger</code></td>
<td>Clase</td>
<td>Permite intercambiar elementos entre dos hilos.</td>
</tr>
</tbody>
</table>
<p>Consulta el <a href="#Ejemplo09">Ejemplo09</a></p>
<h2 id="estructuras-de-datos-concurrentes">Estructuras de datos concurrentes<a class="headerlink" href="#estructuras-de-datos-concurrentes" title="Permanent link">&para;</a></h2>
<p>Java dispone de interfaces y clases para almacenar información con prácticamente cualquier tipo de estructura de datos. Interfaces heredadas de la interface <code>Collection</code>, como <code>List</code>, <code>Map</code>, <code>Set</code>, <code>Qeue</code> o <code>Deque</code>, son la base de una serie de clases que, implementando dichas interfaces, proporcionan el soporte necesario para todo tipo de estructuras de datos.</p>
<p>Desde el punto de vista de la concurrencia, estas implementaciones no están diseñadas para soportar que múltiples hilos lean y escriban simultáneamente en ellas, pudiendo provocar errores.</p>
<p>En el <a href="#Ejemplo10">Ejemplo10</a>, varios hilos leen y escriben en un objeto <code>ArrayList</code> compartido.</p>
<p>La ejecución de este código provoca múltiples errores de concurrencia.</p>
<p>La clase <code>Collections</code> de Java proporciona métodos estáticos para convertir estructuras de datos en seguras respecto a hilos (thread-safe), como <code>synchronizedList</code>, <code>synchronizedMap</code> o <code>synchronizedSet</code> entre otros, pero no son las alternativas más eficientes en todos los casos.</p>
<p>Como alternativa más eficiente si la mayor parte de las operaciones son de lectura, el paquete <code>java.util.concurrent</code> proporciona implementaciones específicamente diseñadas para entornos de ejecución multihilo. Algunas de esas clases se muestran en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Nombre</th>
<th>Tipo</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ConcurrentHashMap</code></td>
<td>Clase</td>
<td>Equivalente a un <code>HashMap</code> sincronizado.</td>
</tr>
<tr>
<td><code>ConcurrentSkipListMap</code></td>
<td>Clase</td>
<td>Equivalente a un <code>TreeMap</code> sincronizado.</td>
</tr>
<tr>
<td><code>CopyOnWriteArrayList</code></td>
<td>Clase</td>
<td>Equivalente a un <code>ArrayList</code> sincronizado.</td>
</tr>
<tr>
<td><code>CopyOnWriteArraySet</code></td>
<td>Clase</td>
<td>Equivalente a un <code>Set</code> sincronizado.</td>
</tr>
</tbody>
</table>
<p>El ejemplo anterior, referente a los lectores y escritores trabajando conjuntamente sobre un <code>ArrayList</code>, se convierte en thead-safe utilizando la clase <code>CopyOnWriteArraySet</code> en lugar de <code>ArrayList</code>, tal y como se puede observar en el <a href="#Ejemplo11">Ejemplo11</a>.</p>
<h2 id="las-interfaces-executorservice-callable-y-future">Las interfaces <code>ExecutorService</code>, <code>Callable</code> y <code>Future</code><a class="headerlink" href="#las-interfaces-executorservice-callable-y-future" title="Permanent link">&para;</a></h2>
<p>Usadas de manera conjunta, estas tres interfaces proporcionan mecanismos para ejecutar el código de manera asíncrona.</p>
<p><code>ExecutorService</code> proporciona el marco de ejecución de código asíncrono contenido en objetos de las interfaces <code>Callable</code> y <code>Runnable</code>. Sus principales métodos se muestran en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Método</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>awaitTermination</code></td>
<td>Bloquea el servicio cuando se recibe una petición de apagado hasta que todas las tareas que tenía asignadas han terminado o se ha alcanzado el tiempo límite E de espera (timeout) o ha habido una interrupción.</td>
</tr>
<tr>
<td><code>invokeAll</code></td>
<td>Permite lanzar una colección de tareas y recoger una lista de objetos <code>Future</code>.</td>
</tr>
<tr>
<td><code>invokeAny</code></td>
<td>Permite lanzar una colección de tareas y recoger el resultado de la que termine satisfactoriamente (si alguna lo hace).</td>
</tr>
<tr>
<td><code>shutdown()</code></td>
<td>Hace que que están el servicio en ejecución deje de y finaliza. aceptar nuevas tareas, espera a que terminen</td>
</tr>
<tr>
<td><code>shutdownNow()</code></td>
<td>Finaliza el servicio sin esperar a que las tareas que tiene en ejecución lo hagan.</td>
</tr>
<tr>
<td><code>submit()</code></td>
<td>Envía a ejecución una tarea <code>Runnable</code> o <code>Callable</code>.</td>
</tr>
</tbody>
</table>
<p>La construcción de instancias de <code>ExecutorService</code> se realiza a través de una serie de métodos estáticos de la clase Executors. Estos métodos permiten indicar la estrategia de hilos que desea que siga el ExecutorService. Algunos de los métodos estáticos de Executors para crear objetos de la interfaz ExecutorService son:</p>
<ul>
<li><code>Executors.newCachedThreadPool()</code>: Crea un <code>ExecutorService</code> con un pool de hilos con todos los que sean necesarios, reutilizando aquellos que están libres.</li>
<li><code>Executors.newFixedThreadPool(int nThreads)</code>: Crea un <code>ExecutorService</code> con un pool con un número determinado de hilos.</li>
<li><code>Executors.newSingleThreadExecutor()</code>: Crea un <code>ExecutorService</code> con un único hilo.</li>
</ul>
<p>Por su parte, la interfaz <code>Callable</code> es una interfaz que funciona similar a <code>Runnable</code>, pero con la diferencia de que puede devolver un retorno y lanzar una excepción. Es una interfaz funcional, ya que solo tiene el método call, por lo que se puede utilizar en expresiones lambda. El código asíncrono de un objeto <code>Callable</code> se ejecuta a través del método submit de <code>ExecutorService</code>.</p>
<p>La interfaz <code>Future</code> representa un resultado futuro generado por un proceso asíncrono. De alguna manera, es un sistema que permite dejar en suspenso la obtención de un resultado hasta que este está disponible. El resultado de invocar al método <code>submit</code> de un <code>ExecutorService</code> es un objeto <code>Future</code>.</p>
<p>Los métodos de la interfaz <code>Future</code> se recogen en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Método</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cancel</code></td>
<td>Intenta cancelar la ejecución de la tarea.</td>
</tr>
<tr>
<td><code>get</code></td>
<td>Espera a que para termine la tarea y obtiene el resultado. En una de sus formas admite un timeout para limitar el tiempo de espera.</td>
</tr>
<tr>
<td><code>isCancelled()</code></td>
<td>Indica si la tarea se ha cancelado antes de terminar.</td>
</tr>
<tr>
<td><code>isDone()</code></td>
<td>Indica si la tarea ha terminado.</td>
</tr>
</tbody>
</table>
<p>En resumen, la relación entre estas tres interfaces es la siguiente: <code>ExecutorService</code> ejecuta un objeto <code>Callable</code> (o <code>Runnable</code>) con una estrategia multihilo determinada y deposita en un objeto <code>Future</code> el retorno futuro de la tarea.</p>
<p>Consulta el <a href="#Ejemplo12">Ejemplo12</a></p>
<blockquote>
<p>En programación, casi nunca una alternativa es siempre mejor que otra. Las interfaces <code>Runnable</code> y <code>Callable</code> son absolutamente válidas y, dependiendo de la situación, una u otra serán la mejor alternativa.</p>
</blockquote>
<h1 id="programacion-asincrona">Programación asíncrona<a class="headerlink" href="#programacion-asincrona" title="Permanent link">&para;</a></h1>
<p>Conceptualmente, la programación asíncrona es independiente del lenguaje de programación en el que se realice, siempre y cuando este la admita. En cambio, a nivel práctico, cada lenguaje de programación proporciona distintas herramientas para permitir la creación y gestión de hilos.</p>
<p>Java es un lenguaje con una extensa biblioteca de clases orientadas a la programación asíncrona o multihilo. Gracias a muchas de estas clases se pueden resolver problemas extremadamente complejos sin excesiva dificultad, ya que implementan soluciones que, de no existir, habría que desarrollar.</p>
<p>En este apartado se muestran los mecanismos básicos de creación, ejecución y sincronización de hilos. Aunque algunos de estos mecanismos ya han sido previamente presentados en esta unidad, se vuelven a presentar de manera resumida con el fin de ofrecer una visión panorámica de los elementos básicos de la programación asíncrona en Java.</p>
<h2 id="la-interfaz-runnable">La interfaz <code>Runnable</code><a class="headerlink" href="#la-interfaz-runnable" title="Permanent link">&para;</a></h2>
<p>Una clase que implementa la interfaz <code>Runnable</code> está concebida para ejecutarse dentro de un thread. El método <code>run</code> es su único método y este no tiene argumentos ni retorno. El contenido del método <code>run</code> se ejecuta de manera asíncrona, por lo que el hilo principal de la aplicación no se detiene, aunque el bloque de código contenido en dicho método lo haga.</p>
<p>Cuando se instancia un objeto de una clase que implementa <code>Runnable</code>, esta se tiene que ejecutar a partir del método <code>start</code> de la instancia de <code>Thread</code> construida a partir del objeto <code>Runnable</code>.</p>
<p>En el <a href="#Ejemplo13">Ejemplo13</a> se muestra la creación y ejecución de 10 threads utilizando objetos de la interfaz <code>Runnable</code>.</p>
<p>Al tratarse de una interfaz funcional, <code>Runnable</code> se puede utilizar en una expresión lambda, disponible en Java desde la versión 8.</p>
<p>Consulta el <a href="#Ejemplo14">Ejemplo14</a> donde se muestra una versión modificada del Ejemplo13 usando la expresión lambda.</p>
<h2 id="la-clase-thread">La clase <code>Thread</code><a class="headerlink" href="#la-clase-thread" title="Permanent link">&para;</a></h2>
<p>La clase <code>Thread</code> representa un hilo de ejecución. Cuando una clase hereda de <code>Thread</code> puede implementar el método <code>run</code> y ejecutarse de forma asíncrona.</p>
<p>Para lanzar un objeto <code>Thread</code> de manera asíncrona, basta ejecutar su método <code>start</code>. El <a href="#Ejemplo15">Ejemplo15</a> muestra la creación y ejecución de un hilo básico utilizando la clase <code>Thread</code>.</p>
<p>En Java, los hilos normales se denominan hilos de usuario, existiendo otro tipo conocido como hilos demonios. Estos hilos se crean a partir de un hilo convencional mediante el método <code>setDaemon</code>. Un hilo demonio constituye un subproceso con una prioridad inferior a la de un hilo de usuario, ejecutándose después. La otra diferencia es que este tipo de hilos tienen utilidad cuando existen hilos de usuario, por lo que cuando estos últimos terminan, finalizan los hilos daemon.</p>
<p>Los métodos principales de la clase <code>Thread</code> se muestran en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Método</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td>Método de inicio del bloque asíncrono de la clase.</td>
</tr>
<tr>
<td><code>run</code></td>
<td>Método en el que se programa el bloque asíncrono. Se ejecuta cuando se invoca el método start.</td>
</tr>
<tr>
<td><code>join</code></td>
<td>Bloquea el hilo hasta que termina el hilo referenciado.</td>
</tr>
<tr>
<td><code>sleep</code></td>
<td>Método estático que detiene temporalmente la ejecución del hilo.</td>
</tr>
<tr>
<td><code>getld</code></td>
<td>Devuelve el identificador del hilo. Es un long positivo generado cuando se crea el hilo.</td>
</tr>
<tr>
<td><code>getName</code></td>
<td>Devuelve el nombre del hilo, asignado en algunas de las formas del constructor.</td>
</tr>
<tr>
<td><code>getState</code></td>
<td>Devuelve el estado del hilo como un valor de la enumeración <code>Thread.State</code>.</td>
</tr>
<tr>
<td><code>interrupt</code></td>
<td>Interrumpe la ejecución del hilo.</td>
</tr>
<tr>
<td><code>interrupted</code></td>
<td>Método estático que comprueba si el hilo actual ha sido interrumpido.</td>
</tr>
<tr>
<td><code>isInterrupted</code></td>
<td>Comprueba si el hilo en el que se encuentra ha sido interrumpido.</td>
</tr>
<tr>
<td><code>isAlive</code></td>
<td>Comprueba si el hilo está vivo.</td>
</tr>
<tr>
<td><code>setPriority</code></td>
<td>Cambia la prioridad del hilo. El valor debe estar entre las constantes <code>MIN_PRIORITY</code> y <code>MAX_PRIORITY</code> de la propia clase <code>Thread</code>. El uso que se haga de las prioridades establecidas viene determinado por el sistema operativo.</td>
</tr>
<tr>
<td><code>setDaemon</code></td>
<td>Permite marcar el hilo como un hilo demonio.</td>
</tr>
<tr>
<td><code>isDaemon</code></td>
<td>Determina si un hilo es un hilo demonio.</td>
</tr>
<tr>
<td><code>yield</code></td>
<td>Método estático que indica al planificador que está dispuesto a ceder su uso actual de procesador. El planificador decide si atiende o no esta sugerencia.</td>
</tr>
</tbody>
</table>
<h2 id="suspension-de-ejecucion-el-metodo-sleep">Suspensión de ejecución: el método <code>sleep</code><a class="headerlink" href="#suspension-de-ejecucion-el-metodo-sleep" title="Permanent link">&para;</a></h2>
<p>El método estático <code>sleep</code> de la clase <code>Thread</code> permite suspender la ejecución del hilo desde el que se invoca. Acepta como parámetro la cantidad de tiempo en milisegundos que se desea realizar esta suspensión, cuya precisión queda sometida a la precisión de los temporizadores del sistema y al planificador.</p>
<h2 id="interrupciones">Interrupciones<a class="headerlink" href="#interrupciones" title="Permanent link">&para;</a></h2>
<p>En computación, una interrupción es una suspensión temporal de la ejecución de un proceso o de un hilo de ejecución. Las interrupciones no suelen pertenece a los programas, sino al sistema operativo, viniendo generadas por peticiones realizadas por los dispositivos periféricos.</p>
<p>En Java, una interrupción es una indicación a un hilo de que debe detener su ejecución para hacer otra cosa. Es responsabilidad del programador decidir qué quiere hacer ante una interrupción, siendo lo más habitual detener la ejecución del hilo.</p>
<p>Las interrupciones se capturan mediante la excepción InterruptedException, provocada por algunas operaciones como la invocación al método sleep. En caso de que la excepción no se tenga que controlar, se deberá invocar al método estático interrupted para Paraninto gestionar la interrupción.</p>
<p>En el <a href="#Ejemplo16">Ejemplo16</a> se realiza la gestión de una excepción que se lanza de manera forzada ante cierta condición. En la captura de la excepción se invoca a la sentencia <code>return</code> para finalizar la ejecución del hilo.</p>
<h2 id="comparticion-de-informacion">Compartición de información<a class="headerlink" href="#comparticion-de-informacion" title="Permanent link">&para;</a></h2>
<p>Varios hilos pueden crearse como instancias de la clase Thread. Los atributos de dichos hilos, si no son estáticos, serán específicos de cada uno de ellos, por lo que no se podrán utilizar para compartir información.</p>
<p>Si se desea que varios hilos compartan información existen varias alternativas:</p>
<ul>
<li><strong>Utilizar atributos estáticos</strong>. Los atributos estáticos son comunes a todas las instancias, por los que independientemente de la manera de construir los hilos la información es compartida.</li>
<li><strong>Utilizando referencias a objetos comunes</strong> accesibles desde todos los hilos. En el <a href="#Ejemplo17">Ejemplo17</a> se muestra un ejemplo de uso de una instancia de un objeto común a varios hilos que se modifican en cada uno de ellos.</li>
<li><strong>Utilizando atributos no estáticos</strong> de la instancia de una clase que implemente <code>RunnableSharing</code> y construyendo los hilos a partir de dicha instancia. El <a href="#Ejemplo18">Ejemplo18</a> muestra un ejemplo.</li>
</ul>
<p>Existen otras formas de compartir información, ya sea a través de ficheros, bases de datos o servicios de red o de internet. En todos los casos hay que tener en cuenta que la información compartida por varios hilos para lectura y escritura es una potencial fuente de errores de concurrencia.</p>
<h1 id="problemas-y-soluciones-de-la-programacion-concurrente-sincronizacion">Problemas y soluciones de la programación concurrente. Sincronización<a class="headerlink" href="#problemas-y-soluciones-de-la-programacion-concurrente-sincronizacion" title="Permanent link">&para;</a></h1>
<p>De manera intrínseca, la programación concurrente tiene dos características que pueden ser fuentes de errores: los recursos compartidos y el orden de ejecución.</p>
<p>En lo referente a la compartición de recursos la problemática es diversa, ya que puede afectar a cómo se modifica el valor de una variable, se accede a los datos de una estructura de datos, se ejecuta un bloque de código o se accede a un recurso limitado.</p>
<p>Para ilustrar este tipo de problemas se puede utilizar el <a href="#Ejemplo19">Ejemplo19</a>.</p>
<p>Es representativo de la problemática de la programación concurrente que en una operación aparentemente tan sencilla puedan surgir errores tan importantes.</p>
<blockquote>
<p>Los problemas de concurrencia no se producen siempre de la misma manera, ya que la ejecución no es determinista. El algoritmo que genera un error cuando 1000 hilos incrementan en 1000 unidades una variable compartida puede funcionar correctamente en la mayoría de los casos con 10 hilos y un incremento de 10 unidades por hilo. No obstante, el riesgo de que un algoritmo pueda fallar, aunque la posibilidad sea baja, normalmente es inaceptable en computación.</p>
</blockquote>
<p>El orden de ejecución, por su parte, tiene que ver con las dependencias que se pueden producir entre los bloques de código en función del orden de ejecución. Si, por ejemplo, un bloque de código necesita como entrada datos generados como salida por otro bloque, esto provocará una dependencia, dado que en un sistema multihilo no se tiene control sobre el orden de las ejecuciones salvo que se establezcan mecanismos de sincronización.</p>
<p>En este apartado se exponen los términos y conceptos más importantes relacionados con los problemas de concurrencia, así como dichos problemas y sus posibles soluciones.</p>
<h2 id="conceptos">Conceptos<a class="headerlink" href="#conceptos" title="Permanent link">&para;</a></h2>
<p>Para poder comprender tanto los problemas como las soluciones relacionados con la programación concurrente es necesario conocer el significado de algunos conceptos. En este apartado se exponen los más importantes.</p>
<h3 id="recursos-compartidos">Recursos compartidos<a class="headerlink" href="#recursos-compartidos" title="Permanent link">&para;</a></h3>
<p>Un recurso compartido es, como su propio nombre indica, un elemento del sistema que es utilizado por varios hilos de ejecución simultáneamente. Puede ser un atributo estático de una clase o un atributo no estático de un objeto compartido por todos los hilos, un método estático de una clase o un método no estático de un objeto compartido por todos los hilos, una conexión a una base de datos, un socket o cualquier elemento con un número limitado de instancias.</p>
<h3 id="dependencias">Dependencias<a class="headerlink" href="#dependencias" title="Permanent link">&para;</a></h3>
<p>Como ya se ha comentado anteriormente, no todas las tareas se pueden ejecutar en un entorno multihilo. Para poder hacerlo hay que tener la certeza de que los segmentos de código que se van a ejecutar en paralelo son independientes y el orden en el que se ejecutan es irrelevante.</p>
<p>Una tarea no se podrá ejecutar en un entorno multihilo si tiene dependencias. Existen tres tipos de dependencias principales:</p>
<ul>
<li>Dependencias de datos. Varios segmentos de código utilizan el mismo dato.</li>
<li>Dependencias de flujos. Debido a que el orden de ejecución del programa no se puede determinar por existir instrucciones de control de flujo existe dependencias potenciales que no se pueden determinar en un análisis estático del código.</li>
<li>Dependencias de recursos. Varios segmentos de código acceden simultáneamente
   a recursos del procesador.</li>
</ul>
<p>La existencia de dependencias de cualquier tipo impide la programación concurrente salvo que se puedan establecer mecanismos de sincronización.</p>
<h3 id="condiciones-de-bernstein">Condiciones de Bernstein<a class="headerlink" href="#condiciones-de-bernstein" title="Permanent link">&para;</a></h3>
<p>De manera formal, el cumplimiento de las condiciones de <strong>Bernstein</strong> determina si dos segmentos de código pueden ser ejecutados en paralelo. Dados dos segmentos de código S<sub>1</sub>, y S<sub>2</sub> se determina que son independientes y pueden ser ejecutados en paralelo si:</p>
<ul>
<li>Las entradas de S<sub>2</sub> son distintas de las salidas de S<sub>1</sub>. De no ser así se produce lo que se conoce como <strong>dependencia de flujo</strong>.</li>
<li>Las entradas de S<sub>1</sub> son distintas de las salidas de S<sub>2</sub>. De no ser así se produce lo que se conoce como <strong>antidependencia</strong>.</li>
<li>Las salidas de S<sub>1</sub> son distintas de las salidas de S<sub>2</sub>. De no ser así se produce lo que se conoce como <strong>dependencia de salida</strong>.</li>
</ul>
<p>Si dos segmentos de código cumplen con las condiciones de <strong>Bernstein</strong> su ejecución se puede paralelizar.</p>
<h3 id="accion-y-acceso-atomicos">Acción y acceso atómicos<a class="headerlink" href="#accion-y-acceso-atomicos" title="Permanent link">&para;</a></h3>
<p>Una acción atómica es aquella que se ejecuta sin interrupciones, de una única vez. Cualquier efecto de la acción solo es visible al finalizar la misma.</p>
<p>En Java, algunas acciones sencillas son atómicas:</p>
<ul>
<li>Leer y escribir variables de los tipos primitivos, excepto los tipos <code>long</code> y <code>double</code>.</li>
<li>Leer y escribir todas las variables declaradas <code>volatile</code>, incluidos los tipos <code>long</code> y <code>double</code>.</li>
</ul>
<blockquote>
<p>Acciones muy sencillas, como incrementar en 1 el valor de una variable de tipo <code>int</code> no son atómicas, por lo que hay que evaluar si es necesario establecer un mecanismo de sincronización.</p>
</blockquote>
<h3 id="seccion-critica">Sección crítica<a class="headerlink" href="#seccion-critica" title="Permanent link">&para;</a></h3>
<p>La sección crítica de un programa multihilo es el bloque de código que accede a recursos compartidos, por lo la que solo debe ser accedido por un único hilo de ejecución. Determinar correctamente la sección crítica permite sincronizar correctamente el programa para evitar errores de concurrencia, así como hacerlo eficiente para poder aprovechar al Ediciones máximo el paralelismo. El garantizar que a la sección crítica solo acceda un hilo de ejecución es lo que se conoce como <strong>exclusión mutua</strong>.</p>
<h3 id="exclusion-mutua">Exclusión mutua<a class="headerlink" href="#exclusion-mutua" title="Permanent link">&para;</a></h3>
<p>Se denomina así a la técnica de programación consistente en hacer que, en un entorno concurrente, un proceso excluya a todos los demás del uso de un recurso compartido (una sección crítica) para garantizar la integridad del sistema.</p>
<h3 id="seguridad-en-hilos-seguro-frente-a-hilos-o-thread-safety">Seguridad en hilos, seguro frente a hilos o <code>Thread safety</code><a class="headerlink" href="#seguridad-en-hilos-seguro-frente-a-hilos-o-thread-safety" title="Permanent link">&para;</a></h3>
<p>Estos términos hacen referencia a la propiedad que tiene un elemento de software (una clase o una estructura de datos, por ejemplo) para ser ejecutado en un entorno de múltiples hilos de forma segura.</p>
<blockquote>
<p>En Java, la documentación de las estructuras de datos suele especificar si son <code>Thread safety</code> o en cambio no están sincronizadas (no son seguras frente a hilos). Es conveniente revisar la documentación de las clases que se utilicen por primera vez en general, prestando especial atención a las referencias a los threads en entornos multihilo.</p>
</blockquote>
<h2 id="problemas-de-la-programacion-concurrente">Problemas de la programación concurrente<a class="headerlink" href="#problemas-de-la-programacion-concurrente" title="Permanent link">&para;</a></h2>
<p>En esta sección se presentan algunos de los problemas que surgen como consecuencia de la programación multihilo, así como las soluciones que se pueden adoptar, tanto genéricas como específicas del lenguaje Java.</p>
<h3 id="interbloqueo-o-deadlock">Interbloqueo o deadlock<a class="headerlink" href="#interbloqueo-o-deadlock" title="Permanent link">&para;</a></h3>
<p>Se produce cuando dos o más hilos están bloqueados entre sí. Por ejemplo, si el hilo A está esperando a que termine el hilo B para continuar su proceso y este, a su vez, está esperando a que termine el hilo A para continuar su proceso se produce un interbloqueo.</p>
<h3 id="muerte-por-inanicion">Muerte por inanición<a class="headerlink" href="#muerte-por-inanicion" title="Permanent link">&para;</a></h3>
<p>Este problema se produce cuando se establece una política de prioridades que provoca
que algunos hilos nunca tengan acceso a la CPU.</p>
<h3 id="condiciones-de-carrera">Condiciones de carrera<a class="headerlink" href="#condiciones-de-carrera" title="Permanent link">&para;</a></h3>
<p>Se produce cuando dos bloques de código concurrente tienen dependencias entre los datos entrada y salida y no se ejecutan en el orden correcto (dependencia de flujo o antidependencia).</p>
<h3 id="inconsistencia-de-memoria">Inconsistencia de memoria<a class="headerlink" href="#inconsistencia-de-memoria" title="Permanent link">&para;</a></h3>
<p>Ocurre cuando dos o más hilos tienen simultáneamente valores diferentes para la misma variable.</p>
<h3 id="condiciones-deslizadas">Condiciones deslizadas<a class="headerlink" href="#condiciones-deslizadas" title="Permanent link">&para;</a></h3>
<p>Se produce cuando en un proceso se evalúa una condición para determinar si se tiene que ejecutar una sección de código y, después de la evaluación y antes de la ejecución, la condición cambia de valor. Se estaría ejecutando un bloque de código cuya condición no se está cumpliendo.</p>
<h2 id="sincronizacion-basica-variables-volatile">Sincronización básica: variables <code>volatile</code><a class="headerlink" href="#sincronizacion-basica-variables-volatile" title="Permanent link">&para;</a></h2>
<p>En un entorno de computación de múltiples núcleos, los procesadores disponen de técnicas de optimización y algunas de ellas se basan en el uso de memoria caché. Estas técnicas habitualmente son ventajosas, pero en la programación concurrente pueden ser una fuente de errores.</p>
<p>Cuando varios hilos comparten la misma variable, si esta se almacena en las cachés de los núcleos, puede ser que los hilos vean copias distintas de la misma variable, lo que puede provocar inconsistencia de memoria.</p>
<p>Para evitar que una variable se almacene en la caché de procesador y que todos los hilos accedan a la misma copia en Java se utiliza la palabra clave volatile. Declarando una variable como volatile solo existirá una copia en el procesador.</p>
<p>El siguiente código de ejemplo muestra la declaración de una variable volatile.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">private</span><span class="w"> </span><span class="kd">volatile</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">contador</span>
</code></pre></div>
<p>Esta solución no resuelve por sí sola todos los problemas de inconsistencia de memoria. Si varios hilos modifican concurrentemente la misma variable, aunque sea declarada volatile, se podría seguir produciendo (habría que incluir mecanismos de sincronización).</p>
<p>Las variables <code>volatile</code> serían apropiadas para sistemas en los que un único hilo modifica el valor de la variable y el resto solamente lo consultan.</p>
<h2 id="sincronizacion-basica-wait-notify-y-notifyall">Sincronización básica: <code>wait</code>, <code>notify</code> y <code>notifyAll</code><a class="headerlink" href="#sincronizacion-basica-wait-notify-y-notifyall" title="Permanent link">&para;</a></h2>
<p>Los métodos <code>wait</code>, <code>notity</code> y <code>notifyAll</code> son propios de la clase <code>Object</code>, por lo que todas las clases en Java disponen de ellos.</p>
<p>Todos estos métodos se tienen que invocar desde segmentos de código de un hilo que disponga de un monitor, como, por ejemplo, un bloque o un segmento sincronizados, y obliga a capturar una excepción del tipo <code>InterruptedException</code>.</p>
<p>El método <code>wait</code> detiene la ejecución del hilo y los métodos <code>notify</code> y <code>notifiyAll</code> producen la reactivación de los hilos detenidos. El método <code>notify</code> hace continuar a un único segmento al azar de los que están detenidos con <code>wait</code> mientras que <code>notifyAll</code> hace continuar a todos los segmentos detenidos con <code>wait</code>.</p>
<p>En el <a href="#Ejemplo20">Ejemplo20</a> se muestra un ejemplo de uso de estos métodos de sincronización. En él, dos hilos creados a partir del mismo objeto ejecutan dos métodos distintos. El primero de los hilos, al realizar la mitad de la tarea entra en espera hasta que el segundo de los hilos finaliza y notifica que debe reanudar la ejecución.</p>
<h2 id="sincronizacion-basica-el-metodo-join">Sincronización básica: el método <code>join</code><a class="headerlink" href="#sincronizacion-basica-el-metodo-join" title="Permanent link">&para;</a></h2>
<p>El método <code>join</code> permite indicar a un hilo que debe suspender su ejecución hasta que termina otro hilo de referencia. Este método debe ejecutarse dentro del bloque asíncrono del código, ya que lo contrario no tendrá ningún efecto.</p>
<p>El <a href="#Ejemplo21">Ejemplo21</a> permite ilustrar el funcionamiento de este método. En él, dos hilos ejecutan un bucle con 3 iteraciones que en ausencia de mecanismos de sincronización generarían una salida similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Thread<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">0</span>
<span class="linenos" data-linenos="2 "></span>Thread<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">0</span>
<span class="linenos" data-linenos="3 "></span>Thread<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="4 "></span>Thread<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="5 "></span>Thread<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos="6 "></span>Thread<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<p>Dado que cada hilo tiene la misma prioridad y el mismo código, escribirán simultáneamente la salida programada.</p>
<p>En cambio, en el <a href="#Ejemplo22">Ejemplo22</a>, después de arrancar los dos hilos, se le indica al hilo <code>hilo2</code> que debe quedar suspendido hasta que termine la ejecución de <code>hilo1</code>. Para ello es necesario que <code>hilo2</code> tenga una referencia a <code>hilo1</code> (<code>referenceThread</code> en el ejemplo) para invocar al método <code>join</code>.</p>
<p>El resultado obtenido en este caso es el siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Thread<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">0</span>
<span class="linenos" data-linenos="2 "></span>Thread<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="3 "></span>Thread<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos="4 "></span>Thread<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">0</span>
<span class="linenos" data-linenos="5 "></span>Thread<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="6 "></span>Thread<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>Interaction<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<h2 id="sincronizacion-basica-estructuras-de-datos-resistentes-a-hilos">Sincronización básica: estructuras de datos resistentes a hilos<a class="headerlink" href="#sincronizacion-basica-estructuras-de-datos-resistentes-a-hilos" title="Permanent link">&para;</a></h2>
<p>Las estructuras de datos convencionales proporcionadas por Java satisfacen cualquier necesidad relacionada con el almacenamiento de datos en memoria. Desde el <code>punto de vista de la programación concurrente hay que tener en cuenta que las clases ArrayList, Vector</code>, <code>HashMap</code> o <code>HashSet</code>, todas ellas del paquete <code>java.util</code> no están sincronizadas, lo que implica que no están programadas para ser consistentes frente al acceso desde múltiples hilos.</p>
<p>Para poder utilizar estas estructuras hay que usar las técnicas de sincronización tratadas en esta unidad, convertirlas a estructuras sincronizadas con los métodos estáticos proporcionados por la clase <code>java.util.Collections</code> (por ejemplo <code>synchronizedList</code> para objetos que implementen la interfaz <code>List</code>) o utilizar las estructuras de datos proporcionadas por el paquete <code>java.util.concurrent</code> y presentadas en un <a href="#Paquete java.util.concurrent">apartado anterior</a>.</p>
<h2 id="sincronizacion-avanzada-exclusion-mutua-synchronized-y-monitores">Sincronización avanzada: exclusión mutua, <code>synchronized</code> y monitores<a class="headerlink" href="#sincronizacion-avanzada-exclusion-mutua-synchronized-y-monitores" title="Permanent link">&para;</a></h2>
<p>Uno de los mecanismos proporcionados por Java para sincronizar segmentos de código consiste en utilizar la palabra clave <code>synchronized</code>. Mediante el uso de synchronized se puede limitar el acceso a un segmento del código a un único hilo concurrentemente, lográndose así la exclusión mutua o mutex. Permite sincronizar tanto métodos como segmentos de código (declaraciones sincronizadas), permitiendo esta última alternativa delimitar la sección crítica con más precisión.</p>
<p>A nivel de método, el uso es tan sencillo como incluir la palabra en la declaración del método:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">calculate</span><span class="w"> </span><span class="p">()</span>
</code></pre></div>
<p>El efecto de esta declaración es que, para una instancia de objeto, solo un hilo puede estar ejecutando el método sincronizado en un momento dado.</p>
<p>Por su parte, a nivel de segmento de código, la sincronización se efectúa delimitando un bloque de sentencias haciendo una declaración sincronizada. El siguiente código muestra una declaración sincronizada.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">calculate</span><span class="p">()(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="c1">//Sentences not synchronized</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">objetoBloqueo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="4 "></span><span class="w">        </span><span class="c1">//Block of unsyncrhonized sentences</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="c1">//Sentences not synchronized</span>
<span class="linenos" data-linenos="7 "></span><span class="p">}</span>
</code></pre></div>
<p>Este sistema utiliza un concepto conocido como bloqueo intrínseco, bloqueo de <code>monitor</code> o, simplemente, <code>monitor</code>. El <code>monitor</code> es un elemento asociado a una instancia que hace la función de candado. Cuando se ejecuta un método o bloque sincronizado utilizando un determinado <code>monitor</code>, este se bloquea y no puede utilizarse hasta que no queda liberado, impidiendo ejecutar un código que utilice el mismo bloqueo.</p>
<p>Cuando se utilizan métodos sincronizados se usa como <code>monitor</code> el objeto en el que están. Esto supone que cuando un método sincronizado de un objeto se está ejecutando ningún otro método sincronizado de ese objeto se puede ejecutar. La exclusión es, por lo tanto, muy genérica y puede que sea poco eficiente en muchos casos.</p>
<p>Consulta el <a href="#Ejemplo23">Ejemplo23</a></p>
<p>Como se ha indicado anteriormente, el comportamiento de los métodos sincronizados del ejemplo se debe a que se ejecutan sobre la misma instancia del objeto que implementa <code>Runnable</code>, por lo que utilizan dicho objeto como monitor provocando el bloqueo.</p>
<p>Si en cambio utilizasen objetos distintos, el resultado sería el mismo que al no marcar los métodos como <code>synchronized</code>, ya que utilizan bloqueos diferentes.</p>
<p>Consulta el <a href="#Ejemplo24">Ejemplo24</a></p>
<p>Por su parte, la sincronización a nivel de segmento necesita también un <code>monitor</code>, pero al no depender del objeto en el que se está ejecutando es más flexible. Utilizando bloques sincronizados no es necesario bloquear todos los segmentos de un objeto como ocurre con los métodos de objeto, sino que se pueden agrupar en monitores distintos.</p>
<p>En el <a href="#Ejemplo25">Ejemplo25</a> se realiza la sincronización a nivel de bloque, utilizando dos bloqueos distintos en cada uno de ellos. De tal manera que los métodos no son exclusivos entre sí. La sincronización se realiza a nivel de método (cada uno de los métodos solo puede estar siendo ejecutado por un objeto simultáneamente, pero ambos métodos se pueden estar ejecutando por dos objetos distintos).</p>
<p>En cambio, si los métodos utilizan el mismo objeto como bloqueo, cuando un objeto esté ejecutando uno de los métodos ningún objeto puede ejecutar ninguno de los dos métodos.</p>
<h2 id="sincronizacion-avanzada-semaforos">Sincronización avanzada: semáforos<a class="headerlink" href="#sincronizacion-avanzada-semaforos" title="Permanent link">&para;</a></h2>
<p>El uso de la palabra clave <code>synchronized</code> permite establecer secciones críticas a las que únicamente tiene acceso un hilo en un momento determinado, pero existen otros escenarios en los que los recursos limitados permiten el acceso de más de un hilo.</p>
<p>Cuando una sección crítica permite ser ejecutada por más de un hilo, pero el número de estos está limitado se utiliza un elemento de programación concurrente conocido como semáforo e implementado en Java por la clase <code>Semaphore</code>.</p>
<p>Los semáforos se suelen utilizar cuando un recurso tiene una capacidad limitada y se desea controlar el número de consumidores de dicho recurso. Es, por lo tanto, un elemento de sincronización.</p>
<p>Al construir el semáforo se le proporciona a través del constructor una capacidad que hace referencia al número de hilos que puede estar ejecutando concurrentemente.</p>
<p>Esta capacidad se convierte en número de permisos de acceso que se conceden a los bloques de código que quieran hacer uso del recurso limitado. Si todos los permisos están concedidos, los hilos quedan en espera a que los propietarios de los permisos los liberen.</p>
<p>Los principales métodos de la clase semáforo son los que se recogen a continuación en la siguiente tabla.</p>
<table>
<thead>
<tr>
<th>Método</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>acquire</code></td>
<td>Adquiere uno o más permisos del semáforo si hay alguno disponible. En caso contrario el hilo queda a la espera.</td>
</tr>
<tr>
<td><code>release</code></td>
<td>Libera uno o más permisos concedidos previamente.</td>
</tr>
<tr>
<td><code>tryAcquire</code></td>
<td>Intenta obtener uno o más permisos, pudiendo quedar en espera durante un tiempo limitado.</td>
</tr>
</tbody>
</table>
<p>Además de estos métodos la clase <code>Semaphore</code> proporciona métodos de gestión y consulta del estado del semáforo.</p>
<p>En el <a href="#Ejemplo26">Ejemplo26</a> ejemplo, se construye con semáforo con capacidad para tres permisos. A su vez, cinco hilos construidos a partir de la misma instancia de <code>Runnable</code> acceden a la sección crítica, solicitan el permiso, realizan los pasos de la actividad sincronizada y liberan el bloqueo.</p>
<blockquote>
<p>No solo se pueden utilizar los semáforos cuando los recursos son limitados. En ocasiones es conveniente limitar el número de hilos que realizan determinadas tareas para no saturar el sistema o alguno de sus componentes. Por ejemplo, limitar el número de hilos que acceden a servicios web o a bases de datos puede ser una estrategia adecuada en muchos casos.</p>
</blockquote>
<h1 id="ejemplos">Ejemplos<a class="headerlink" href="#ejemplos" title="Permanent link">&para;</a></h1>
<h2 id="ejemplo01">Ejemplo01<a class="headerlink" href="#ejemplo01" title="Permanent link">&para;</a></h2>
<p>Ejemplo con un único hilo de ejecución:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Mouse</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Mouse</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">feedingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has started to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">feedingTime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has stopped to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">fievel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Fievel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">jerry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Jerry&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">pinky</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Pinky&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">mickey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Mickey&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="n">fievel</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="n">jerry</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="n">pinky</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="n">mickey</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="32 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida producida por la ejecución es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="2 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="3 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Jerry<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="4 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Jerry<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="5 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Pinky<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="6 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Pinky<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="7 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Mickey<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="8 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Mickey<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
</code></pre></div>
<h2 id="ejemplo02">Ejemplo02<a class="headerlink" href="#ejemplo02" title="Permanent link">&para;</a></h2>
<p>Ejemplo multihilo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Mouse</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Mouse</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">feedingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has started to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">feedingTime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has stopped to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">fievel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Fievel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">jerry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Jerry&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">pinky</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Pinky&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">mickey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Mickey&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="n">fievel</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="n">jerry</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="n">pinky</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="n">mickey</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="37 "></span><span class="p">}</span>
</code></pre></div>
<p>Ejemplo de salida de su ejecución:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="2 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Jerry<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="3 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Pinky<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="4 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Mickey<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="5 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Pinky<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="6 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="7 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Jerry<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="8 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Mickey<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
</code></pre></div>
<p>Todos los ratones han comenzado a alimentarse de inmediato, sin esperar a que termine ninguno de los demás. El tiempo total del proceso será, aproximadamente, el tiempo del proceso más lento (en este caso, 6 segundos). La reducción del tiempo total de ejecución es evidente.</p>
<h2 id="ejemplo03">Ejemplo03<a class="headerlink" href="#ejemplo03" title="Permanent link">&para;</a></h2>
<p>Retomando el enunciado del ejemplo de los objetos de la clase Raton, la solución mediante implementación de la interface Runnable tendría el código que se muestra a continuación, revisa las partes del código que se han modificado respecto de la solución anterior en la que se heredaba de Thread.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Mouse</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Mouse</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">feedingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has started to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">feedingTime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has stopped to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">fievel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Fievel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">jerry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Jerry&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">pinky</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Pinky&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="n">Mouse</span><span class="w"> </span><span class="n">mickey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Mouse</span><span class="p">(</span><span class="s">&quot;Mickey&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">fievel</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">jerry</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">pinky</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">mickey</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="37 "></span><span class="p">}</span>
</code></pre></div>
<p>El resultado de ejecución:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Fievel</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="2 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Pinky</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="3 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Jerry</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="4 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Mickey</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">started</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="5 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Pinky</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="6 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Fievel</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="7 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Jerry</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
<span class="linenos" data-linenos="8 "></span><span class="n">The</span><span class="w"> </span><span class="n">mouse</span><span class="w"> </span><span class="n">Mickey</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">feed</span>
</code></pre></div>
<p>Se puede observar que el código es muy similar, salvo en la declaración de la clase (implementación de una interface frente a herencia) y en la creación de los hilos y su arranque: los objetos <code>Runnable</code> deben «envolverse» en objetos <code>Thread</code> para poder ser arrancados. Es importante apreciar que en ambos casos la ejecución se realiza invocando al método <code>start</code>.</p>
<h2 id="ejemplo04">Ejemplo04<a class="headerlink" href="#ejemplo04" title="Permanent link">&para;</a></h2>
<p>Ejemplo multihilo a partir de un único.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SimpleMouse</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">consumedFood</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">SimpleMouse</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">feedingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has started to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">feedingTime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">consumedFood</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has stopped to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Consumed food: %d%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">consumedFood</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="29 "></span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="n">SimpleMouse</span><span class="w"> </span><span class="n">fievel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleMouse</span><span class="p">(</span><span class="s">&quot;Fievel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">fievel</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">fievel</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">fievel</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">fievel</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="37 "></span><span class="p">}</span>
</code></pre></div>
<p>El resultado de la ejecución es el siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 2 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 3 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 4 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 5 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 6 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 7 "></span>Consumed<span class="w"> </span>food:<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos=" 8 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos=" 9 "></span>Consumed<span class="w"> </span>food:<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos="10 "></span>Consumed<span class="w"> </span>food:<span class="w"> </span><span class="m">4</span>
<span class="linenos" data-linenos="11 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Fievel<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="12 "></span>Consumed<span class="w"> </span>food:<span class="w"> </span><span class="m">4</span>
</code></pre></div>
<p>Cada hilo ha ejecutado el método <code>run</code> sobre los datos del mismo objeto. Es decir, se ha ejecutado simultáneamente cuatro veces un bloque de código de un único objeto, compartiendo sus atributos. De esta forma, en la salida se puede apreciar que el valor del atributo <code>consumedFood</code> se ha incrementado en 1 por cada hilo. Esto se puede observar porque el valor de <code>consumedFood</code> se ha incrementado varias veces durante la ejecución. El hecho de que algunos valores intermedios no aparezcan en la siguiente captura de la salida de la ejecución tiene que ver con la <code>asincronía</code> y el alto coste de ejecución que tienen las sentencias que escriben por pantalla.</p>
<p>Aunque se tratará más adelante en esta misma unidad, es importante insistir en que los diferentes hilos del ejemplo anterior están trabajando sobre una única copia del objeto en memoria, por lo que las variables (los atributos) son compartidas, pudiendo sufrir errores de concurrencia.</p>
<h2 id="ejemplo04bis">Ejemplo04bis<a class="headerlink" href="#ejemplo04bis" title="Permanent link">&para;</a></h2>
<p>Por ejemplo, sustituyendo el método main del ejemplo anterior por el siguiente código, se pueden crear y ejecutar varios threads mediante un bucle for a partir de una única instancia de una clase que implementa la interfaz <code>Runnable</code>. El resultado, con un número bajo de iteraciones (por ejemplo, 4) será habitualmente correcto (el atributo <code>consumedFood</code> alcanzará el mismo valor que el número de iteraciones). Con un número alto (por ejemplo, 1000 iteraciones) el resultado será habitualmente erróneo (el atributo <code>consumedFood</code> alcanzará un valor por debajo del número de iteraciones). Esto se debe a que al compartir todos los hilos los mismos atributos producen errores de concurrencia que deben evitarse mediante técnicas concretas que veremos más adelante.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">SimpleMouse</span><span class="w"> </span><span class="n">fievel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleMouse</span><span class="p">(</span><span class="s">&quot;Fievel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="4 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">fievel</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="6 "></span><span class="p">}</span>
</code></pre></div>
<p>En una ejecución del código anterior, el resultado es 998, cuando debería haber sido 1000 si no hubiese habido problemas de concurrencia</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Consumed<span class="w"> </span>food:<span class="w"> </span><span class="m">998</span>
</code></pre></div>
<h2 id="ejemplo05">Ejemplo05<a class="headerlink" href="#ejemplo05" title="Permanent link">&para;</a></h2>
<p>Listado de estados por los que pasa un hilo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SimpleMouse</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">consumedFood</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">SimpleMouse</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">feedingTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">feedingTime</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">eat</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has started to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">feedingTime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="n">consumedFood</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;The mouse %s has stopped to feed%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Consumed food: %d%n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">consumedFood</span><span class="p">);</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="23 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">eat</span><span class="p">();</span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="n">SimpleMouse</span><span class="w"> </span><span class="n">mickey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleMouse</span><span class="p">(</span><span class="s">&quot;Mickey&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Thread</span><span class="p">.</span><span class="na">State</span><span class="o">&gt;</span><span class="w"> </span><span class="n">threadState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">();</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="n">Thread</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">mickey</span><span class="p">);</span>
<span class="linenos" data-linenos="36 "></span><span class="w">        </span><span class="n">threadState</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
<span class="linenos" data-linenos="37 "></span><span class="w">        </span><span class="n">h</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="38 "></span>
<span class="linenos" data-linenos="39 "></span><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="na">getState</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Thread</span><span class="p">.</span><span class="na">State</span><span class="p">.</span><span class="na">TERMINATED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="40 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">threadState</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="na">getState</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="41 "></span><span class="w">                </span><span class="n">threadState</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
<span class="linenos" data-linenos="42 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="43 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="44 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">threadState</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="na">getState</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="45 "></span><span class="w">            </span><span class="n">threadState</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="na">getState</span><span class="p">());</span>
<span class="linenos" data-linenos="46 "></span>
<span class="linenos" data-linenos="47 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="48 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">State</span><span class="w"> </span><span class="n">estado</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">threadState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="49 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">estado</span><span class="p">);</span>
<span class="linenos" data-linenos="50 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="51 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="52 "></span><span class="p">}</span>
</code></pre></div>
<p>Al finalizar la ejecución se muestran los estados recogidos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Mickey<span class="w"> </span>has<span class="w"> </span>started<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="2 "></span>The<span class="w"> </span>mouse<span class="w"> </span>Mickey<span class="w"> </span>has<span class="w"> </span>stopped<span class="w"> </span>to<span class="w"> </span>feed
<span class="linenos" data-linenos="3 "></span>Consumed<span class="w"> </span>food:<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="4 "></span>NEW
<span class="linenos" data-linenos="5 "></span>RUNNABLE
<span class="linenos" data-linenos="6 "></span>TIMED_WAITING
<span class="linenos" data-linenos="7 "></span>TERMINATED
</code></pre></div>
<h2 id="ejemplo06">Ejemplo06<a class="headerlink" href="#ejemplo06" title="Permanent link">&para;</a></h2>
<p>En el siguiente ejemplo se muestra un uso conjunto de las clases <code>Timer</code> y <code>TimerTask</code>. El programa simula controlar un sistema de regadío automático. Este sistema riega por primera vez transcurridos <code>1000</code> milisegundos desde el inicio de la ejecución y repite el riego cada <code>2000</code> milisegundos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Timer</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.TimerTask</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IrrigationSystem</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">TimerTask</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Watering...&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="n">Timer</span><span class="w"> </span><span class="n">timer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Timer</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="n">timer</span><span class="p">.</span><span class="na">schedule</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">IrrigationSystem</span><span class="p">(),</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida generada transcurridos unos segundos es la que se muestra a continuación. Entre la escritura de cada línea transcurren 2000 milisegundos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Watering...
<span class="linenos" data-linenos="2 "></span>Watering...
<span class="linenos" data-linenos="3 "></span>Watering...
<span class="linenos" data-linenos="4 "></span>...
</code></pre></div>
<h2 id="ejemplo07">Ejemplo07<a class="headerlink" href="#ejemplo07" title="Permanent link">&para;</a></h2>
<p>El siguiente ejemplo ilustra el uso de <code>ScheduledExecutorService</code> como herramienta para la programación de ejecuciones de tareas. Como se puede observar, mediante la clase <code>Executors</code> se obtiene una instancia de <code>ScheduledExecutorService</code>, que es la interface que permite programar tareas recurrentes en hilos independientes. Una vez obtenido el programador de tareas, se le indica qué tarea se quiere ejecutar (objeto <code>sr</code>), cuántas unidades de tiempo se desea esperar hasta que se inicie la primera tarea (1), cuántas unidades de tiempo se desea esperar entre cada repetición de la tarea (2) y en qué unidad están representadas las unidades de tiempo (<code>TimeUnit.SECONDS</code>)</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Executors</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.ScheduledExecutorService</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.TimeUnit</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IrrigationSystem</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Watering...&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="n">IrrigationSystem</span><span class="w"> </span><span class="n">ir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IrrigationSystem</span><span class="p">();</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">ScheduledExecutorService</span><span class="w"> </span><span class="n">ses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Executors</span><span class="p">.</span><span class="na">newSingleThreadScheduledExecutor</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="n">ses</span><span class="p">.</span><span class="na">scheduleAtFixedRate</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Configured irrigation system&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida de la ejecución transcurridos unos segundos es la que se muestra a continuación. Entre cada escritura del texto «Regando» transcurren dos segundos.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Configured<span class="w"> </span>irrigation<span class="w"> </span>system
<span class="linenos" data-linenos="2 "></span>Watering...
<span class="linenos" data-linenos="3 "></span>Watering...
</code></pre></div>
<h2 id="ejemplo08">Ejemplo08<a class="headerlink" href="#ejemplo08" title="Permanent link">&para;</a></h2>
<p>Para ilustrar mejor el comportamiento de este tipo de soluciones se presenta el siguiente ejemplo. utiliza Una cola recibe escrituras y lecturas de un conjunto de hilos. La primera solución utiliza una estructura de datos <code>LinkedList</code> como un soporte. Al no ser esta estructura segura frente a múltiples hilos, la ejecución produce un error.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.LinkedList</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Queue</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">nonConcurrentQueue</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">queue</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">queue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Queue size:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">queue</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">nonConcurrentQueue</span><span class="p">()).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida será similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>Exception<span class="w"> </span><span class="k">in</span><span class="w"> </span>thread<span class="w"> </span><span class="s2">&quot;Thread-1&quot;</span><span class="w"> </span>Exception<span class="w"> </span><span class="k">in</span><span class="w"> </span>thread<span class="w"> </span><span class="s2">&quot;Thread-0&quot;</span><span class="w"> </span>java.util.ConcurrentModificationException
<span class="linenos" data-linenos=" 2 "></span><span class="m">1</span>:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:6
<span class="linenos" data-linenos=" 3 "></span>Queue<span class="w"> </span>size:4
<span class="linenos" data-linenos=" 4 "></span>Queue<span class="w"> </span>size:5
<span class="linenos" data-linenos=" 5 "></span>Queue<span class="w"> </span>size:3
<span class="linenos" data-linenos=" 6 "></span><span class="m">1</span>:1:1:1:1:1:1:Queue<span class="w"> </span>size:7
<span class="linenos" data-linenos=" 7 "></span><span class="m">1</span>:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:8
<span class="linenos" data-linenos=" 8 "></span><span class="m">1</span>:1:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:9
<span class="linenos" data-linenos=" 9 "></span><span class="m">1</span>:1:1:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:10
<span class="linenos" data-linenos="10 "></span><span class="w">    </span>at<span class="w"> </span>java.base/java.util.LinkedList<span class="nv">$ListItr</span>.checkForComodification<span class="o">(</span>LinkedList.java:970<span class="o">)</span>
<span class="linenos" data-linenos="11 "></span><span class="o">[</span>...<span class="o">]</span>
</code></pre></div>
<h2 id="ejemplo08bis">Ejemplo08bis<a class="headerlink" href="#ejemplo08bis" title="Permanent link">&para;</a></h2>
<p>La segunda solución utiliza el mismo código cambiando la estructura de datos a <code>ConcurrentLinkedDeque</code> obteniendo una ejecución sin errores.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Queue</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.ConcurrentLinkedDeque</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConcurrentQueue</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcurrentLinkedDeque</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">queue</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">queue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;:&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Queue size:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">queue</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ConcurrentQueue</span><span class="p">()).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="p">}</span>
</code></pre></div>
<p>Salida obtenida:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="m">1</span>:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:2
<span class="linenos" data-linenos=" 2 "></span>Queue<span class="w"> </span>size:4
<span class="linenos" data-linenos=" 3 "></span>Queue<span class="w"> </span>size:2
<span class="linenos" data-linenos=" 4 "></span>Queue<span class="w"> </span>size:7
<span class="linenos" data-linenos=" 5 "></span>Queue<span class="w"> </span>size:7
<span class="linenos" data-linenos=" 6 "></span>Queue<span class="w"> </span>size:7
<span class="linenos" data-linenos=" 7 "></span>Queue<span class="w"> </span>size:3
<span class="linenos" data-linenos=" 8 "></span><span class="m">1</span>:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:9
<span class="linenos" data-linenos=" 9 "></span><span class="m">1</span>:Queue<span class="w"> </span>size:9
<span class="linenos" data-linenos="10 "></span><span class="m">1</span>:1:1:1:1:1:1:1:1:1:Queue<span class="w"> </span>size:10
</code></pre></div>
<p>Aunque de esta última ejecución no está ordenada debido a la concurrencia de los hilos, sí se puede observar que la ejecución ha generado una cola con 10 elementos correspondientes a los 10 hilos que estaban accediendo a leer y escribir en la estructura de datos.</p>
<h2 id="ejemplo09">Ejemplo09<a class="headerlink" href="#ejemplo09" title="Permanent link">&para;</a></h2>
<p>En el siguiente ejemplo se muestra el uso de <code>Exchanger</code>. Se crean dos clases que implementan <code>Runnable</code>, <code>TaskA</code> y <code>TaskB</code>. Ambas clases reciben una instancia de <code>Exchanger</code> en el constructor y la utilizan para intercambiar información entre sí. La llamada al método <code>exchange</code> por parte de una de las dos tareas producirá un bloqueo de espera hasta que la otra tarea haga lo propio, intercambiando en ese momento la información entre los dos hilos. Por su parte, la clase <code>Commuter</code>, construye tanto el objeto <code>Exchanger</code> como las dos tareas programadas en <code>TaskA</code> y <code>TaskB</code>. Es importante prestar atención al hecho de que las tareas no tienen referencias la una de la otra, sino que tienen acceso al objeto que hace de «intercambiador» de información.</p>
<p><code>TaskA</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TaskA</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">TaskA</span><span class="p">(</span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exchanger</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">exchanger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">receivedMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exchanger</span><span class="p">.</span><span class="na">exchange</span><span class="p">(</span><span class="s">&quot;Message sent by TaskA&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Message received in TaskA: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">receivedMessage</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
<p><code>TaskB</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TaskB</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">TaskB</span><span class="p">(</span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exchanger</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">exchanger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">receivedMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exchanger</span><span class="p">.</span><span class="na">exchange</span><span class="p">(</span><span class="s">&quot;Message sent by TaskB&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Message received in TaskB: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">receivedMessage</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="p">}</span>
</code></pre></div>
<p><code>Commuter</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Exchanger</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Commuter</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exchanger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Exchanger</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TaskA</span><span class="p">(</span><span class="n">exchanger</span><span class="p">)).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">TaskB</span><span class="p">(</span><span class="n">exchanger</span><span class="p">)).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida obtenida será:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Message<span class="w"> </span>received<span class="w"> </span><span class="k">in</span><span class="w"> </span>TaskA:<span class="w"> </span>Message<span class="w"> </span>sent<span class="w"> </span>by<span class="w"> </span>TaskB
<span class="linenos" data-linenos="2 "></span>Message<span class="w"> </span>received<span class="w"> </span><span class="k">in</span><span class="w"> </span>TaskB:<span class="w"> </span>Message<span class="w"> </span>sent<span class="w"> </span>by<span class="w"> </span>TaskA
</code></pre></div>
<h2 id="ejemplo10">Ejemplo10<a class="headerlink" href="#ejemplo10" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">nonSafeReaderWriter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">words</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;New word&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">words</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">words</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">words</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">nonSafeReaderWriter</span><span class="p">().</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="p">}</span>
</code></pre></div>
<p>En la salida aparecen referencias a excepciones que indican que han ocurrido errores de concurrencia en el acceso a la lista, como <code>java.util.ConcurrentModificationException</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">[</span>...<span class="o">]</span>
<span class="linenos" data-linenos="2 "></span>Exception<span class="w"> </span><span class="k">in</span><span class="w"> </span>thread<span class="w"> </span><span class="s2">&quot;Thread-21&quot;</span><span class="w"> </span>java.util.ConcurrentModificationException
<span class="linenos" data-linenos="3 "></span><span class="o">[</span>...<span class="o">]</span>
</code></pre></div>
<h2 id="ejemplo11">Ejemplo11<a class="headerlink" href="#ejemplo11" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.CopyOnWriteArrayList</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">safeReaderWriter</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CopyOnWriteArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">words</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;New word&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">words</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">words</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">words</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">safeReaderWriter</span><span class="p">().</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="p">}</span>
</code></pre></div>
<p>Que esta vez se ejecuta sin problemas ni errores.</p>
<h2 id="ejemplo12">Ejemplo12<a class="headerlink" href="#ejemplo12" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Callable</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.ExecutorService</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Executors</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Future</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Reader</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">call</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">readedText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;I like action movies&quot;</span><span class="p">;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">readedText</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">Reader</span><span class="w"> </span><span class="n">reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Reader</span><span class="p">();</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">ExecutorService</span><span class="w"> </span><span class="n">executionService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Executors</span><span class="p">.</span><span class="na">newSingleThreadExecutor</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="n">Future</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">executionService</span><span class="p">.</span><span class="na">submit</span><span class="p">(</span><span class="n">reader</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">get</span><span class="p">();</span>
<span class="linenos" data-linenos="21 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">isDone</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">text</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Process finished&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">isCancelled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Process cancelled&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="26 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span><span class="w">            </span><span class="n">executionService</span><span class="p">.</span><span class="na">shutdown</span><span class="p">();</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="32 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida producida es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Me<span class="w"> </span>gustan<span class="w"> </span>las<span class="w"> </span>películas<span class="w"> </span>de<span class="w"> </span>acción
<span class="linenos" data-linenos="2 "></span>Proceso<span class="w"> </span>finalizado
</code></pre></div>
<p>Como se ha indicado anteriormente, la principal diferencia entre implementar <code>Callable</code> y <code>Runnable</code> es que la primera opción puede proporcionar un retorno. No obstante, con <code>Runnable</code> existen técnicas para transmitir valores mediante el uso de referencias a objetos.</p>
<h2 id="ejemplo13">Ejemplo13<a class="headerlink" href="#ejemplo13" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BasicRunnable</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">BasicRunnable</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Processing thread &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="n">BasicRunnable</span><span class="w"> </span><span class="n">br</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BasicRunnable</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">br</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida generada para una ejecución cualquiera será similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">9</span>
<span class="linenos" data-linenos=" 2 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos=" 3 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">5</span>
<span class="linenos" data-linenos=" 4 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">6</span>
<span class="linenos" data-linenos=" 5 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos=" 6 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">7</span>
<span class="linenos" data-linenos=" 7 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">8</span>
<span class="linenos" data-linenos=" 8 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">4</span>
<span class="linenos" data-linenos=" 9 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos="10 "></span>Processing<span class="w"> </span>thread<span class="w"> </span><span class="m">0</span>
</code></pre></div>
<p>Como se puede observar, el orden de las escrituras no coincide con el orden de las ejecuciones de los hilos.</p>
<h2 id="ejemplo14">Ejemplo14<a class="headerlink" href="#ejemplo14" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BasicRunnableLambda</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">BasicRunnableLambda</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">BasicRunnableLambda</span><span class="w"> </span><span class="n">br</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BasicRunnableLambda</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Processing thread &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">br</span><span class="p">.</span><span class="na">id</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">                    </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">                    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="19 "></span><span class="w">                </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="p">}).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida no difiere del ejemplo anterior.</p>
<h2 id="ejemplo15">Ejemplo15<a class="headerlink" href="#ejemplo15" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BasicThread</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">BasicThread</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="kd">super</span><span class="p">();</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Processing thread &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">            </span><span class="n">BasicThread</span><span class="w"> </span><span class="n">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BasicThread</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="22 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">bt</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida no difiere de la clase que implementamos anteriormente con <code>Runnable</code>.</p>
<h3 id="ejemplo16">Ejemplo16<a class="headerlink" href="#ejemplo16" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BasicInterruption</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">counter</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="s">&quot;Interruption&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="12 "></span><span class="w">                    </span><span class="k">this</span><span class="p">.</span><span class="na">interrupt</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">                </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">BasicInterruption</span><span class="p">().</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="25 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida al ejecutar el código debe ser:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="m">1</span>
<span class="linenos" data-linenos="2 "></span><span class="m">2</span>
<span class="linenos" data-linenos="3 "></span><span class="m">3</span>
<span class="linenos" data-linenos="4 "></span>Interruption
</code></pre></div>
<h2 id="ejemplo17">Ejemplo17<a class="headerlink" href="#ejemplo17" title="Permanent link">&para;</a></h2>
<p>SharedObject class:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SharedObject</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">sharedVariable</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="p">}</span>
</code></pre></div>
<p>UniqueInstanceSharing class:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UniqueInstanceSharing</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">SharedObject</span><span class="w"> </span><span class="n">so</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">UniqueInstanceSharing</span><span class="p">(</span><span class="n">SharedObject</span><span class="w"> </span><span class="n">so</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">so</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">so</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">so</span><span class="p">.</span><span class="na">sharedVariable</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Shared Variable: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">so</span><span class="p">.</span><span class="na">sharedVariable</span><span class="p">);</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="n">SharedObject</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SharedObject</span><span class="p">();</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="n">UniqueInstanceSharing</span><span class="w"> </span><span class="n">uis1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UniqueInstanceSharing</span><span class="p">(</span><span class="n">so</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="n">UniqueInstanceSharing</span><span class="w"> </span><span class="n">uis2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UniqueInstanceSharing</span><span class="p">(</span><span class="n">so</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="n">uis1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="n">uis2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida será similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Shared<span class="w"> </span>Variable:<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="2 "></span>Shared<span class="w"> </span>Variable:<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<h2 id="ejemplo18">Ejemplo18<a class="headerlink" href="#ejemplo18" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">RunnableSharing</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">counter</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Counter: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">counter</span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="n">RunnableSharing</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RunnableSharing</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">rs</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span><span class="p">}</span>
</code></pre></div>
<p>Debes obtener una salida similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">[</span>...<span class="o">]</span>
<span class="linenos" data-linenos="2 "></span>Counter:<span class="w"> </span><span class="m">998</span>
<span class="linenos" data-linenos="3 "></span>Counter:<span class="w"> </span><span class="m">999</span>
<span class="linenos" data-linenos="4 "></span>Counter:<span class="w"> </span><span class="m">1000</span>
</code></pre></div>
<p>En este caso aunque llamemos más de 1000 veces no existen problemas al acceder a la variable <code>counter</code>.</p>
<h2 id="ejemplo19">Ejemplo19<a class="headerlink" href="#ejemplo19" title="Permanent link">&para;</a></h2>
<p>En este ejemplo 1000 hilos incrementan en 1000 unidades una variable estática común. La variable debería obtener como resultado 1000000.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SharedVariable</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">counter</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">SharedVariable</span><span class="p">().</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Counter value: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">counter</span><span class="p">);</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="p">}</span>
</code></pre></div>
<p>Obtendremos una salida similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Counter<span class="w"> </span>value:<span class="w"> </span><span class="m">993203</span>
</code></pre></div>
<p>Que dista bastante del valor esperado. Esto es debido a que la operación de incremento con el operador unario ++ no realiza una operación atómica (que se ejecuta sin interrupciones), sino que consta de varios pasos y la ejecución se puede interrumpir en cualquiera de ellos, provocando un problema de inconsistencia de memoria.</p>
<p>Suponiendo que el proceso de incremento en 1 de una variable está compuesto de los siguientes pasos:</p>
<ul>
<li>Lectura del valor de la variable.</li>
<li>Incremento en 1 del valor de la variable.</li>
<li>Escritura del valor de la variable.</li>
</ul>
<p>Si un hilo lee el valor de la variable siendo este 2, calcula el nuevo valor y antes de escribir el 3 resultante otro hilo toma su lugar en el procesador, este leerá de nuevo 2, calculará el nuevo valor que será 3 y lo escribirá, cuando el primer hilo vuelva al procesador continuará ejecutando el tercer paso y escribiendo el valor 3. Dos hilos han incrementado en 1 el valor de una misma variable, pero al finalizar solo se ha reflejado uno de los incrementos. Esto explica las pérdidas de incrementos que se muestran en el ejemplo.</p>
<h2 id="ejemplo20">Ejemplo20<a class="headerlink" href="#ejemplo20" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SimpleWaitNotify</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">volatile</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">runningMethod1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Method1: Running %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="10 "></span><span class="w">                    </span><span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span>
<span class="linenos" data-linenos="11 "></span><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">                    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">                </span><span class="p">}</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Method2: Running %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="26 "></span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">runningMethod1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">            </span><span class="n">runningMethod1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">            </span><span class="n">method1</span><span class="p">();</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="32 "></span><span class="w">            </span><span class="n">method2</span><span class="p">();</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="34 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="37 "></span><span class="w">        </span><span class="n">SimpleWaitNotify</span><span class="w"> </span><span class="n">swn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleWaitNotify</span><span class="p">();</span>
<span class="linenos" data-linenos="38 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">swn</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="39 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">swn</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="40 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="41 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida debe ser:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>Running<span class="w"> </span><span class="m">0</span>
<span class="linenos" data-linenos=" 2 "></span>Running<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos=" 3 "></span>Running<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos=" 4 "></span>Running<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos=" 5 "></span>Running<span class="w"> </span><span class="m">4</span>
<span class="linenos" data-linenos=" 6 "></span>Running<span class="w"> </span><span class="m">5</span>
<span class="linenos" data-linenos=" 7 "></span>Running<span class="w"> </span><span class="m">10</span>
<span class="linenos" data-linenos=" 8 "></span>Running<span class="w"> </span><span class="m">11</span>
<span class="linenos" data-linenos=" 9 "></span>Running<span class="w"> </span><span class="m">12</span>
<span class="linenos" data-linenos="10 "></span>Running<span class="w"> </span><span class="m">13</span>
<span class="linenos" data-linenos="11 "></span>Running<span class="w"> </span><span class="m">14</span>
<span class="linenos" data-linenos="12 "></span>Running<span class="w"> </span><span class="m">15</span>
<span class="linenos" data-linenos="13 "></span>Running<span class="w"> </span><span class="m">16</span>
<span class="linenos" data-linenos="14 "></span>Running<span class="w"> </span><span class="m">17</span>
<span class="linenos" data-linenos="15 "></span>Running<span class="w"> </span><span class="m">18</span>
<span class="linenos" data-linenos="16 "></span>Running<span class="w"> </span><span class="m">19</span>
<span class="linenos" data-linenos="17 "></span>Running<span class="w"> </span><span class="m">6</span>
<span class="linenos" data-linenos="18 "></span>Running<span class="w"> </span><span class="m">7</span>
<span class="linenos" data-linenos="19 "></span>Running<span class="w"> </span><span class="m">8</span>
<span class="linenos" data-linenos="20 "></span>Running<span class="w"> </span><span class="m">9</span>
</code></pre></div>
<h2 id="ejemplo21">Ejemplo21<a class="headerlink" href="#ejemplo21" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Basic</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Basic</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Thread %d. Interaction %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="16 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="n">Basic</span><span class="w"> </span><span class="n">thread1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Basic</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span><span class="w">        </span><span class="n">Basic</span><span class="w"> </span><span class="n">thread2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Basic</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="n">thread1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="n">thread2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="27 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="ejemplo22">Ejemplo22<a class="headerlink" href="#ejemplo22" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BasicJoin</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">suspend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="n">referenceThread</span><span class="p">;</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">BasicJoin</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">threadSuspend</span><span class="p">(</span><span class="n">Thread</span><span class="w"> </span><span class="n">referenceThread</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">suspend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">referenceThread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">referenceThread</span><span class="p">;</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="20 "></span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">suspend</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">                    </span><span class="n">referenceThread</span><span class="p">.</span><span class="na">join</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span><span class="w">                </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Thread %d. Interaction %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span><span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="25 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="27 "></span><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="28 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="n">BasicJoin</span><span class="w"> </span><span class="n">thread1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BasicJoin</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos="33 "></span><span class="w">        </span><span class="n">BasicJoin</span><span class="w"> </span><span class="n">thread2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BasicJoin</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="n">thread1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="n">thread2</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="36 "></span><span class="w">        </span><span class="n">thread2</span><span class="p">.</span><span class="na">threadSuspend</span><span class="p">(</span><span class="n">thread1</span><span class="p">);</span>
<span class="linenos" data-linenos="37 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="38 "></span><span class="p">}</span>
</code></pre></div>
<h2 id="ejemplo23">Ejemplo23<a class="headerlink" href="#ejemplo23" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MethodSyncronization</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 1 start&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 1 ends&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 2 start&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 2 ends&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="n">method1</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="n">method2</span><span class="p">();</span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="n">MethodSyncronization</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MethodSyncronization</span><span class="p">();</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">ms</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">ms</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="33 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="34 "></span><span class="p">}</span>
</code></pre></div>
<p>Los métodos se ejecutarán de uno en uno, pese a que se dispone de dos hilos distintos. La salida generada es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="2 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="3 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="4 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
<span class="linenos" data-linenos="5 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="6 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="7 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="8 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
</code></pre></div>
<p>Recuerda que el orden puede variar, lo importante es que los métodos se ejecutan todos unos detrás de otros.</p>
<p>Si los métodos no estuviesen sincronizados (<code>MethodSyncronizationBis</code>) los dos hilos ejecutarían simultáneamente el primer método, tras su finalización, el segundo. La salida habría resultado la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="2 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="3 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="4 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="5 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="6 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="7 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
<span class="linenos" data-linenos="8 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
</code></pre></div>
<h2 id="ejemplo24">Ejemplo24<a class="headerlink" href="#ejemplo24" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">WrongMethodSyncronization</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 1 start&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 1 ends&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 2 start&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="19 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Method 2 ends&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="24 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">        </span><span class="n">method1</span><span class="p">();</span>
<span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="n">method2</span><span class="p">();</span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="30 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">WrongMethodSyncronization</span><span class="p">().</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="31 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">WrongMethodSyncronization</span><span class="p">().</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="32 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="33 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida en este caso será:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="2 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="3 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="4 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="5 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="6 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="7 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
<span class="linenos" data-linenos="8 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
</code></pre></div>
<h2 id="ejemplo25">Ejemplo25<a class="headerlink" href="#ejemplo25" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SegmentSyncronization</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">block1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="p">();</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">block2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="p">();</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">SegmentSyncronization</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">block1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Method 1 from thread %d start\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="15 "></span><span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="17 "></span><span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Method 1 from thread %d ends\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="22 "></span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">method2</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="24 "></span><span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">block2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="25 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Method 2 from thread %d start\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="linenos" data-linenos="26 "></span><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="27 "></span><span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="28 "></span><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="29 "></span><span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="linenos" data-linenos="30 "></span><span class="w">            </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;Method 2 from thread %d ends\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="linenos" data-linenos="32 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="33 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="34 "></span>
<span class="linenos" data-linenos="35 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="36 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="37 "></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="38 "></span><span class="w">            </span><span class="n">method1</span><span class="p">();</span>
<span class="linenos" data-linenos="39 "></span><span class="w">            </span><span class="n">method2</span><span class="p">();</span>
<span class="linenos" data-linenos="40 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="41 "></span><span class="w">            </span><span class="n">method2</span><span class="p">();</span>
<span class="linenos" data-linenos="42 "></span><span class="w">            </span><span class="n">method1</span><span class="p">();</span>
<span class="linenos" data-linenos="43 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="44 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="45 "></span>
<span class="linenos" data-linenos="46 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="47 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">SegmentSyncronization</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="48 "></span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">SegmentSyncronization</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="49 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="50 "></span><span class="p">}</span>
</code></pre></div>
<p>La salida será similar a esta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="2 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="3 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="4 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
<span class="linenos" data-linenos="5 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">1</span><span class="w"> </span>start
<span class="linenos" data-linenos="6 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">2</span><span class="w"> </span>start
<span class="linenos" data-linenos="7 "></span>Method<span class="w"> </span><span class="m">2</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">1</span><span class="w"> </span>ends
<span class="linenos" data-linenos="8 "></span>Method<span class="w"> </span><span class="m">1</span><span class="w"> </span>from<span class="w"> </span>thread<span class="w"> </span><span class="m">2</span><span class="w"> </span>ends
</code></pre></div>
<h2 id="ejemplo26">Ejemplo26<a class="headerlink" href="#ejemplo26" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="kn">package</span><span class="w"> </span><span class="nn">UD02.Example26</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.Semaphore</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BasicSemaphore</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="n">Semaphore</span><span class="w"> </span><span class="n">semaphore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Semaphore</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="nd">@Override</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="12 "></span><span class="w">            </span><span class="n">semaphore</span><span class="p">.</span><span class="na">acquire</span><span class="p">();</span>
<span class="linenos" data-linenos="13 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Step 1&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="15 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Step 2&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Step 3&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="18 "></span><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="linenos" data-linenos="19 "></span><span class="w">            </span><span class="n">semaphore</span><span class="p">.</span><span class="na">release</span><span class="p">();</span>
<span class="linenos" data-linenos="20 "></span><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">            </span><span class="n">ie</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="linenos" data-linenos="22 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="23 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="26 "></span><span class="w">        </span><span class="n">BasicSemaphore</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BasicSemaphore</span><span class="p">();</span>
<span class="linenos" data-linenos="27 "></span><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos" data-linenos="28 "></span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">sb</span><span class="p">).</span><span class="na">start</span><span class="p">();</span>
<span class="linenos" data-linenos="29 "></span><span class="w">        </span><span class="p">}</span>
<span class="linenos" data-linenos="30 "></span><span class="w">    </span><span class="p">}</span>
<span class="linenos" data-linenos="31 "></span><span class="p">}</span>
</code></pre></div>
<p>Salida:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>Step<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos=" 2 "></span>Step<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos=" 3 "></span>Step<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos=" 4 "></span>Step<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos=" 5 "></span>Step<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos=" 6 "></span>Step<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos=" 7 "></span>Step<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos=" 8 "></span>Step<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos=" 9 "></span>Step<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos="10 "></span>Step<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="11 "></span>Step<span class="w"> </span><span class="m">1</span>
<span class="linenos" data-linenos="12 "></span>Step<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos="13 "></span>Step<span class="w"> </span><span class="m">2</span>
<span class="linenos" data-linenos="14 "></span>Step<span class="w"> </span><span class="m">3</span>
<span class="linenos" data-linenos="15 "></span>Step<span class="w"> </span><span class="m">3</span>
</code></pre></div>
<p>La salida  muestra  que  los tres primeros hilos que han intentado acceder a la sección crítica a través del bloqueo del semáforo se han ejecutado concurrentemente, y el resto de los hilos se han ejecutado cuando los primeros han terminado y liberado los bloqueos.</p>
<h1 id="fuentes-de-informacion">Fuentes de información<a class="headerlink" href="#fuentes-de-informacion" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://en.wikipedia.org">Wikipedia</a></li>
<li><a href="https://www.paraninfo.es/catalogo/9788413665269/programacion-de-servicios-y-procesos">Programación de servicios y procesos - FERNANDO PANIAGUA MARTÍN [Paraninfo]</a></li>
<li><a href="https://www.ra-ma.es/libro/programacion-de-servicios-y-procesos-grado-superior_49240/">Programación de Servicios y Procesos - ALBERTO SÁNCHEZ CAMPOS [Ra-ma]</a></li>
<li><a href="https://www.garceta.es">Programación de Servicios y Procesos - Mª JESÚS RAMOS MARTÍN - [Garceta] (1ª y 2ª Edición)</a></li>
<li><a href="https://www.sintesis.com/desarrollo%20de%20aplicaciones%20multiplataforma-341/programaci%C3%B3n%20de%20servicios%20y%20procesos-ebook-2910.html">Programación de servicios y procesos - CARLOS ALBERTO CORTIJO BON [Sintesis]</a></li>
<li><a href="https://ioc.xtec.cat/materials/FP/Recursos/fp_dam_m09_/web/fp_dam_m09_htmlindex/index.html">Programació de serveis i processos - JOAR ARNEDO MORENO, JOSEP CAÑELLAS BORNAS i JOSÉ ANTONIO LEO MEGÍAS [IOC]</a></li>
<li>GitHub repositories:</li>
<li>https://github.com/ajcpro/psp</li>
<li>https://oscarmaestre.github.io/servicios/index.html</li>
<li>https://github.com/juanro49/DAM/tree/master/DAM2/PSP</li>
<li>https://github.com/pablohs1986/dam_psp2021</li>
<li>https://github.com/Perju/DAM</li>
<li>https://github.com/eldiegoch/DAM</li>
<li>https://github.com/eldiegoch/2dam-psp-public</li>
<li>https://github.com/franlu/DAM-PSP</li>
<li>https://github.com/ProgProcesosYServicios</li>
<li>https://github.com/joseluisgs</li>
<li>https://github.com/oscarnovillo/dam2_2122</li>
<li>https://github.com/PacoPortillo/DAM_PSP_Tarea02_La-Cena-de-los-Filosofos</li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Darrera actualització">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">16 d’octubre del 2024</span>
  </span>

    
    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2024 Xavier Sastre - Llicencia CC BY-NC-SA <a href="#__consent">Canvia configuració de les galetes</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  





<h4>Consentiment ús galetes</h4>
<p>Utilitzem galetes per reconèixer les vostres visites, així com mesurar l'eficàcia de la nostra documentació i si els usuaris troben allò que estan buscant. Amb el teu consentiment, ens ajudes a millorar la nostra documentació.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
          
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accepta</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Rebutja</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Gestiona la configuració</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "toc.integrate", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiat al porta-retalls", "clipboard.copy": "C\u00f2pia al porta-retalls", "search.result.more.one": "1 m\u00e9s en aquesta p\u00e0gina", "search.result.more.other": "# m\u00e9s en aquesta p\u00e0gina", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.term.missing": "Desaparegut", "select.version": "Selecciona la versi\u00f3"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>