
<!doctype html>
<html lang="ca" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://xsastre.github.io/Antics/6.5.Activitat.html">
      
      
      
      
      <link rel="icon" href="../imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>Activitat 5.5: VideoClub - Docencia Xavier</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans Condensed";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#activitat-55-videoclub" class="md-skip">
          Salta el contingut
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Capçalera">
    <a href=".." title="Docencia Xavier" class="md-header__button md-logo" aria-label="Docencia Xavier" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Docencia Xavier
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Activitat 5.5: VideoClub
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="Teal"  aria-label="Canviar a mode dia"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Canviar a mode dia" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Cerca" placeholder="Cerca" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Cerca">
        
        <button type="reset" class="md-search__icon md-icon" title="Neteja" aria-label="Neteja" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicialitzant cerca
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegació" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Docencia Xavier" class="md-nav__button md-logo" aria-label="Docencia Xavier" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Docencia Xavier
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Inici
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Inici
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inici
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DWEC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            DWEC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Moduls/DWEC/_DWEC2425.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desenvolupament web en entorn client - DAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Moduls/DWEC/desenvolupamentfrontend.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desenvolupamet frontend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    AW
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            AW
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Moduls/AW/00.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temporització aproximada
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Moduls/AW/01.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aplicacions web
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Moduls/AW/02.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="activitat-55-videoclub">Activitat 5.5: VideoClub<a class="headerlink" href="#activitat-55-videoclub" title="Permanent link">&para;</a></h1>
<p>En els exercicis d'aquesta secció anem a completar el projecte del videoclub utilitzant el component de styde per a modicar vistes i menu. Afegirem la funcionalitat per que un usuari puga llogar una pel.lícula.</p>
<h3 id="exercisi-1-installa-el-component-styde">Exercisi 1 - Instal.la el component styde<a class="headerlink" href="#exercisi-1-installa-el-component-styde" title="Permanent link">&para;</a></h3>
<h3 id="exercisi-2-refactorizar-el-formulari">Exercisi 2 - Refactorizar el formulari<a class="headerlink" href="#exercisi-2-refactorizar-el-formulari" title="Permanent link">&para;</a></h3>
<p>En primer lloc, anem a canviar el formulari 'create'. Substituïm tot el codi html per este que utilitza la classe Form dels components instal.lats. El formulari està associat està associat a un model i posse els camps que en fan falta. No cal possar el @csfr doncs es possa automàticament.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span> {!! Form::model(&#39;App\Movie&#39;,[&#39;class&#39;=&gt;&#39;form-horizontal form-label-left&#39;,&#39;enctype&#39;=&gt;&quot;multipart/form-data&quot;]) !!}
<span class="linenos" data-linenos="2 "></span>    {!! Field::text(&#39;title&#39;) !!}
<span class="linenos" data-linenos="3 "></span>    {!! Field::text(&#39;year&#39;) !!}
<span class="linenos" data-linenos="4 "></span>    {!! Field::text(&#39;director&#39;) !!}
<span class="linenos" data-linenos="5 "></span>    {!! Field::text(&#39;poster&#39;) !!}
<span class="linenos" data-linenos="6 "></span>    {!! Field::textarea(&#39;synopsis&#39;) !!}
<span class="linenos" data-linenos="7 "></span>    {!! Form::submit(&#39;Enviar&#39;,[&#39;class&#39;=&gt;&#39;btn btn-success&#39;,&#39;id&#39;=&gt;&#39;submit&#39;]) !!}
<span class="linenos" data-linenos="8 "></span>{!! Form::close() !!}
</code></pre></div>
<ul>
<li>Canvia, de la mateixa forma, el formulari de modificació, tenint en compte que si en conte de passar-li el model li passe un element del model, el valors s'afegisen al formulari.</li>
</ul>
<h3 id="exercisi-3-comprovar-les-dades-del-formulari">Exercisi 3 - Comprovar les dades del formulari<a class="headerlink" href="#exercisi-3-comprovar-les-dades-del-formulari" title="Permanent link">&para;</a></h3>
<p>Tots els camp son requerits.
L'any ha de ser un número major de 1900 i menor que l'any actual.</p>
<h3 id="exercisi-4-refactoritzar-els-metodes-create-i-update">Exercisi 4 - Refactoritzar els mètodes create i update<a class="headerlink" href="#exercisi-4-refactoritzar-els-metodes-create-i-update" title="Permanent link">&para;</a></h3>
<p>Anem a utilitzar l'assignament massiu per a omplir tots els camp a l'hora. Pots fer-ho declarant en el model la variable <strong>$fillable</strong> o la variable <strong>$guard</strong></p>
<p>Després hauràs de substituir l'assignació de tots els camps, en el metodes create i update, per l'instrucció:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>$movie-&gt;fill($request-&gt;toArray());
</code></pre></div>
<h3 id="exercisi-5-afegir-relacio-u-a-molts">Exercisi 5 - Afegir relació u a molts.<a class="headerlink" href="#exercisi-5-afegir-relacio-u-a-molts" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Crea un taula, mitjançant una migració(create_genres_table) que es diga genres (generè en anglés) ('id','titulo') </p>
</li>
<li>
<p>Anem a crear una migració alter_movies_table per afegir un camp (id_genre) i crear la clau forània amb genres.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>&lt;?php
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span>use Illuminate\Support\Facades\Schema;
<span class="linenos" data-linenos=" 4 "></span>use Illuminate\Database\Schema\Blueprint;
<span class="linenos" data-linenos=" 5 "></span>use Illuminate\Database\Migrations\Migration;
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span>class AlterMoviesTable extends Migration
<span class="linenos" data-linenos=" 8 "></span>{
<span class="linenos" data-linenos=" 9 "></span>    /**
<span class="linenos" data-linenos="10 "></span>     * Run the migrations.
<span class="linenos" data-linenos="11 "></span>     *
<span class="linenos" data-linenos="12 "></span>     * @return void
<span class="linenos" data-linenos="13 "></span>     */
<span class="linenos" data-linenos="14 "></span>    public function up()
<span class="linenos" data-linenos="15 "></span>    {
<span class="linenos" data-linenos="16 "></span>        Schema::table(&#39;movies&#39;, function (Blueprint $table) {
<span class="linenos" data-linenos="17 "></span>            $table-&gt;integer(&#39;id_genre&#39;)-&gt;unsigned()-&gt;nullable();
<span class="linenos" data-linenos="18 "></span>            $table-&gt;foreign(&#39;id_genre&#39;)-&gt;references(&#39;id&#39;)-&gt;on(&#39;genres&#39;)-&gt;onUpdate(&#39;CASCADE&#39;)-&gt;onDelete(&#39;SET NULL&#39;);
<span class="linenos" data-linenos="19 "></span>    });
<span class="linenos" data-linenos="20 "></span>    }
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>    /**
<span class="linenos" data-linenos="23 "></span>     * Reverse the migrations.
<span class="linenos" data-linenos="24 "></span>     *
<span class="linenos" data-linenos="25 "></span>     * @return void
<span class="linenos" data-linenos="26 "></span>     */
<span class="linenos" data-linenos="27 "></span>    public function down()
<span class="linenos" data-linenos="28 "></span>    {
<span class="linenos" data-linenos="29 "></span>        Schema::table(&#39;movies&#39;, function (Blueprint $table) {
<span class="linenos" data-linenos="30 "></span>            $table-&gt;dropForeign(&#39;movies_id_genre_foreign&#39;);
<span class="linenos" data-linenos="31 "></span>            $table-&gt;dropColumn(&#39;id_genre&#39;);
<span class="linenos" data-linenos="32 "></span>        });
<span class="linenos" data-linenos="33 "></span>    }
</code></pre></div>
<p>}</p>
</li>
<li>
<p>Executa la migració i comprova que tot s'ha executat correctament.</p>
</li>
<li>Emplena la taula Genres amb uns quants.</li>
<li>Afegix el model Genre.</li>
<li>
<p>Afegix la rel.lació belongsTo al model Movie per vincular-la al model Genre.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public function Genero(){
<span class="linenos" data-linenos="2 "></span>        return $this-&gt;belongsTo(Genre::class,&#39;id_genre&#39;);
<span class="linenos" data-linenos="3 "></span>    }
</code></pre></div>
</li>
<li>
<p>Afegix la rel.lació HasMany al model Genre.</p>
</li>
<li>
<p>Per tal que en la vista es motre el titol del gènere:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>&lt;p&gt;&lt;strong&gt;Genere:&lt;/strong&gt;
<span class="linenos" data-linenos="2 "></span> @if ($pelicula-&gt;Genero)  {{ $pelicula-&gt;Genero-&gt;titulo}} 
<span class="linenos" data-linenos="3 "></span> @else Desconocido
<span class="linenos" data-linenos="4 "></span> @endif
<span class="linenos" data-linenos="5 "></span>&lt;/p&gt;
</code></pre></div>
</li>
</ul>
<h3 id="exercisi-6-afegir-el-camp-genere-al-formulari">Exercisi 6 - Afegir el camp Gènere al formulari.<a class="headerlink" href="#exercisi-6-afegir-el-camp-genere-al-formulari" title="Permanent link">&para;</a></h3>
<p>Anem a utilitza el component d'Styde:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>{!! Field::select(&#39;id_genre&#39;) !!}
</code></pre></div>
<p>que posarem a les vistes. Si a este component li passem un array de paràmetres, es possarà com a valors seleccionables:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>{!! Field::select(&#39;id_genre&#39;,[&#39;terror&#39;,&#39;musical&#39;,&#39;thriller&#39;]) !!}
</code></pre></div>
<p>També es pot declarar una funció en el model Movie per a que torne els valors.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public function getIdGenreOptions(){
<span class="linenos" data-linenos="2 "></span>    return [&#39;terror&#39;,&#39;musical&#39;,&#39;thriller&#39;]
<span class="linenos" data-linenos="3 "></span>}
</code></pre></div>
<p>Però el que volem és que els valor s'agafem de la <strong>taula Genres</strong>. Tal i com així:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public function getIdGenreOptions()
<span class="linenos" data-linenos="2 "></span>{
<span class="linenos" data-linenos="3 "></span>    return Genre::all()-&gt;toArray();
<span class="linenos" data-linenos="4 "></span>}
</code></pre></div>
<p>Però aço no acaba de funcionar perquè torna un array d'esta forma</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>array:2 [▼
<span class="linenos" data-linenos=" 2 "></span>  0 =&gt; array:2 [▼
<span class="linenos" data-linenos=" 3 "></span>    &quot;id&quot; =&gt; 1
<span class="linenos" data-linenos=" 4 "></span>    &quot;titulo&quot; =&gt; &quot;Terror&quot;
<span class="linenos" data-linenos=" 5 "></span>  ]
<span class="linenos" data-linenos=" 6 "></span>  1 =&gt; array:2 [▼
<span class="linenos" data-linenos=" 7 "></span>    &quot;id&quot; =&gt; 2
<span class="linenos" data-linenos=" 8 "></span>    &quot;titulo&quot; =&gt; &quot;Fantástico&quot;
<span class="linenos" data-linenos=" 9 "></span>  ]
<span class="linenos" data-linenos="10 "></span>]
</code></pre></div>
<p>però per a que funcionara hauria de ser d'aquesta altra</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>array:2 [▼
<span class="linenos" data-linenos="2 "></span>  1 =&gt; &quot;Terror&quot;
<span class="linenos" data-linenos="3 "></span>  2 =&gt; &quot;Fantástico&quot;
<span class="linenos" data-linenos="4 "></span>  ]
<span class="linenos" data-linenos="5 "></span>]
</code></pre></div>
<p>Aixì que anem a fer una funció genèrica php que donada una col.lecció d'objectes i dos camps del mateix, genere un array per a l'option.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>function hazArray($elementos,&#39;campo1&#39;,&#39;campo2&#39;)
<span class="linenos" data-linenos="2 "></span>{
<span class="linenos" data-linenos="3 "></span>    return $array
<span class="linenos" data-linenos="4 "></span>}
</code></pre></div>
<p>i la cridariem de la següent forma:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>public function getIdGenreOptions()
<span class="linenos" data-linenos="2 "></span>{
<span class="linenos" data-linenos="3 "></span>    return hazArray(Genre::all(),&#39;id&#39;,&#39;titulo&#39;);
<span class="linenos" data-linenos="4 "></span>}
</code></pre></div>
<p>De moment declara-la com a privada en el model per a provar que funciona.</p>
<p><strong>Nota: en Laravel, per a poder vore el valor d'una variable i para l'execució del programa s'utilitza la funció dd($variable)</strong> </p>
<p>Però, esta funció ha de poser ser visible en tota la  aplicació. Per tal de aconseguir-ho anem a crear un fitxer on guardar les nostres funcions genèriques.</p>
<ul>
<li>Crea una carpeta <strong>Helpers</strong> dins de <strong>app</strong></li>
<li>Crea un fitxer <strong>myHelpers</strong> dins d'aquesta carpeta.</li>
<li>copia la funció hazArray</li>
</ul>
<p>Per a que les funcions d'aquest fitxer siguen visibles en l'aplicació anem a crear un ServiceProvider i a registrar-lo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php artisan make:provider HelperServiceProvider
</code></pre></div>
<p>Crearà un fitxer en la carpeta Providers.
L'editem per afegir el nostre Helper.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>/**
<span class="linenos" data-linenos="2 "></span>     * Register services.
<span class="linenos" data-linenos="3 "></span>     *
<span class="linenos" data-linenos="4 "></span>     * @return void
<span class="linenos" data-linenos="5 "></span>     */
<span class="linenos" data-linenos="6 "></span>    public function register()
<span class="linenos" data-linenos="7 "></span>    {
<span class="linenos" data-linenos="8 "></span>        require_once base_path() . &#39;/app/Helpers/myHelpers.php&#39;;
<span class="linenos" data-linenos="9 "></span>    }
</code></pre></div>
<p>I ara registrem el ServiceProvider en el fitxer <strong>config/app.php</strong></p>
<p>'providers' =&gt; [</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>    /*
<span class="linenos" data-linenos=" 2 "></span>     * Laravel Framework Service Providers...
<span class="linenos" data-linenos=" 3 "></span>     */
<span class="linenos" data-linenos=" 4 "></span>    Illuminate\Auth\AuthServiceProvider::class,
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span>    .....
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    /*
<span class="linenos" data-linenos=" 9 "></span>     * Package Service Providers...
<span class="linenos" data-linenos="10 "></span>     */
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span>    /*
<span class="linenos" data-linenos="13 "></span>     * Application Service Providers...
<span class="linenos" data-linenos="14 "></span>     */
<span class="linenos" data-linenos="15 "></span>    App\Providers\AppServiceProvider::class,
<span class="linenos" data-linenos="16 "></span>    App\Providers\AuthServiceProvider::class,
<span class="linenos" data-linenos="17 "></span>    // App\Providers\BroadcastServiceProvider::class,
<span class="linenos" data-linenos="18 "></span>    App\Providers\EventServiceProvider::class,
<span class="linenos" data-linenos="19 "></span>    App\Providers\RouteServiceProvider::class,
<span class="linenos" data-linenos="20 "></span>    App\Providers\HelperServiceProvider::class,
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span>],
</code></pre></div>
<p>I com cada volta que toquen un fitxer de configuració executem</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>php artisan config:cache
</code></pre></div>
<p>I tot ha de funcionar. Ja podem triar un gènere en cada pel.licula.</p>
<h3 id="exercisi-7-el-component-de-menu-styde">Exercisi 7 - El component de menu styde.<a class="headerlink" href="#exercisi-7-el-component-de-menu-styde" title="Permanent link">&para;</a></h3>
<p>Anem a fer el menu des d'un fitxer de text utilitzan el component de menu del paquet instal.lat</p>
<p>Substituïm el navbar per :</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>&lt;nav class=&quot;navbar navbar-expand-md navbar-light navbar-laravel&quot;&gt;
<span class="linenos" data-linenos=" 2 "></span>    &lt;div class=&quot;container&quot;&gt;
<span class="linenos" data-linenos=" 3 "></span>        &lt;a class=&quot;navbar-brand&quot; href=&quot;{{url(&#39;/&#39;)}}&quot;&gt;
<span class="linenos" data-linenos=" 4 "></span>            &lt;span class=&quot;glyphicon glyphicon-tower&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;
<span class="linenos" data-linenos=" 5 "></span>            Videoclub
<span class="linenos" data-linenos=" 6 "></span>        &lt;/a&gt;
<span class="linenos" data-linenos=" 7 "></span>        &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#navbarSupportedContent&quot; aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;{{ __(&#39;Toggle navigation&#39;) }}&quot;&gt;
<span class="linenos" data-linenos=" 8 "></span>                &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
<span class="linenos" data-linenos=" 9 "></span>        &lt;/button&gt;
<span class="linenos" data-linenos="10 "></span>        @if( Auth::check() )
<span class="linenos" data-linenos="11 "></span>            {!! Menu::make(config(&#39;menu&#39;), &#39;navbar-nav mr-auto&#39;) !!}
<span class="linenos" data-linenos="12 "></span>        @endif
<span class="linenos" data-linenos="13 "></span>    &lt;/div&gt;
<span class="linenos" data-linenos="14 "></span>&lt;/nav&gt;
</code></pre></div>
<p>on config('menu') enllaça en un fitxer que hem de crear en la carpeta config i de nom menu.php. Este haurà de contindre:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>&lt;?php
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span>return [
<span class="linenos" data-linenos="4 "></span>    &#39;catalogo&#39; =&gt; [&#39;url&#39; =&gt; &#39;/catalog&#39;],
<span class="linenos" data-linenos="5 "></span>    &#39;nueva&#39; =&gt; [&#39;title&#39; =&gt; &#39;Nueva Película&#39;, &#39;url&#39; =&gt; &#39;/catalog/create&#39;],
<span class="linenos" data-linenos="6 "></span>    &#39;logout&#39; =&gt; [&#39;title&#39; =&gt; &#39;Cerrar Sesion&#39; ,&#39;url&#39; =&gt; &#39;/logout&#39;]
<span class="linenos" data-linenos="7 "></span>];
</code></pre></div>
<p><strong>Cal fer php artisan config:cache</strong></p>
<p>On estan les opcions de menu.</p>
<h3 id="exercisi-8-completant-botons">Exercisi 8 - Completant botons<a class="headerlink" href="#exercisi-8-completant-botons" title="Permanent link">&para;</a></h3>
<p>En aquest exercici anem a afegir la funcionalitat dels botons de llogar, retornar i eliminar pel·lícules. En tots els casos haurem de crear una nova ruta, un nou mètode en el controlador , actualitzar el boton en la vista i mostrar una notificació despres de realitzar l'acció. En la següent taula es mostra un resum de la nova ruta a afegir:</p>
<table>
<thead>
<tr>
<th>Ruta</th>
<th>Tipus</th>
<th>Controlador/Acció</th>
</tr>
</thead>
<tbody>
<tr>
<td>/catalog/rent/{id}</td>
<td>PUT</td>
<td>CatalogController@putRent</td>
</tr>
<tr>
<td>/catalog/return/{id}</td>
<td>PUT</td>
<td>CatalogController@putReturn</td>
</tr>
<tr>
<td>/catalog/delete/{id}</td>
<td>DELETE</td>
<td>CatalogController@deleteMovie</td>
</tr>
</tbody>
</table>
<p>Aquests tres mètodes són similars al mètode que ja havíem implementat abans per a editar les dades d'una pel.lícula. En el cas de <strong>putRent</strong> i <strong>putReturn</strong> únicament modificarem el camp <strong>rented</strong> assignant-li el valor true i false respectivament i una vegada guardat crearem la notificació i realitzarem una redirecció a la pantalla amb la vista detalle de la pel.lícula. En el mètode deleteMovie també obtindrem el registre de la pel·lícula però haurem de cridar al mètode delete() de la mateixa, una vegada fet açò afegirem la notificació i realitzarem una redirecció al llistat general de pel·lícules.</p>
<p>A continuació hem d'editar la vista detalle de pel·lícules per a modificar els botons (show.blade). Atès que les accions han de realitzaren utilitzant peticions HTTP tipus PUT i DELETE no podem posar un enllaç normal (ja que seria de tipus GET). Per a solucionar-ho hem de crear un formulari al voltant del botó i assignar al formulari el mètode corresponent.</p>
<p>Per exemple:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>&lt;form action= {{action(&#39;CatalogController@putReturn&#39;,$pelicula-&gt;id)}} method=&quot;POST&quot; style=&quot;display:inline&quot;&gt;
<span class="linenos" data-linenos="2 "></span>    {{ method_field(&#39;PUT&#39;) }}
<span class="linenos" data-linenos="3 "></span>    {{ csrf_field() }}
<span class="linenos" data-linenos="4 "></span>    &lt;button type=&quot;submit&quot; class=&quot;btn btn-danguer&quot; style= &quot;display:inline&quot; &gt; Devolver Película&lt;/button&gt;
<span class="linenos" data-linenos="5 "></span>&lt;/form&gt;
</code></pre></div>
<h3 id="exercisi-9-fes-un-manteniment-per-a-la-taula-de-generes-i-fica-la-al-menu">Exercisi 9 - Fes un manteniment per a la taula de gèneres i fica-la al menu.<a class="headerlink" href="#exercisi-9-fes-un-manteniment-per-a-la-taula-de-generes-i-fica-la-al-menu" title="Permanent link">&para;</a></h3>
<p>Per a fer submenus amb styde :</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>return [
<span class="linenos" data-linenos=" 2 "></span>    &#39;catalogo&#39; =&gt; [ &#39;submenu&#39; =&gt; [
<span class="linenos" data-linenos=" 3 "></span>            &#39;lista&#39; =&gt;[ &#39;title&#39;=&gt; &#39;Catálogo&#39;, &#39;url&#39; =&gt; &#39;/catalog&#39;],
<span class="linenos" data-linenos=" 4 "></span>            &#39;nueva&#39; =&gt; [&#39;title&#39; =&gt; &#39;Nueva Película&#39;, &#39;url&#39; =&gt; &#39;/catalog/create&#39;],
<span class="linenos" data-linenos=" 5 "></span>        ]],
<span class="linenos" data-linenos=" 6 "></span>        &#39;genero&#39; =&gt; [&#39;submenu&#39; =&gt; [ 
<span class="linenos" data-linenos=" 7 "></span>            &#39;genre&#39; =&gt; [&#39;title&#39; =&gt; &#39;Mantenimiento Generos&#39; , &#39;url&#39; =&gt; &#39;/genre&#39;],
<span class="linenos" data-linenos=" 8 "></span>            &#39;nuevo&#39; =&gt; [&#39;title&#39; =&gt; &#39;Nuevo Genero&#39;, &#39;url&#39; =&gt; &#39;/genre/create&#39;]
<span class="linenos" data-linenos=" 9 "></span>            ]],
<span class="linenos" data-linenos="10 "></span>    &#39;logout&#39; =&gt; [&#39;title&#39; =&gt; &#39;Cerrar Sesion&#39; ,&#39;url&#39; =&gt; &#39;/logout&#39;]
<span class="linenos" data-linenos="11 "></span>];
</code></pre></div>
<h3 id="exercisi-10-fes-que-quan-polse-en-una-pellicula-sobre-un-genere-misquen-les-pellicules-deixe-genere">Exercisi 10 - Fes que quan polse en una pel.licula sobre un gènere, m'isquen les pel.licules d'eixe gènere.<a class="headerlink" href="#exercisi-10-fes-que-quan-polse-en-una-pellicula-sobre-un-genere-misquen-les-pellicules-deixe-genere" title="Permanent link">&para;</a></h3>
<p>També amb les desconegudes.</p>
<h3 id="exercisi-11-paginacio">Exercisi 11 - Paginaciò.<a class="headerlink" href="#exercisi-11-paginacio" title="Permanent link">&para;</a></h3>
<p>Hi ha diverses formes de paginar elements. La més senzilla és utilitzar el mètode paginate del generador de consultes (query builder) o d'un model Eloquent. Partint d'un model de <strong>eloquent</strong> es poden paginar de la següent manera:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>    $allUsers = User::paginate(15);
<span class="linenos" data-linenos="2 "></span>    $someUsers = User::where(&#39;votes&#39;, &#39;&gt;&#39;, 100)-&gt;paginate(15);
</code></pre></div>
<p>L'argument passat al mètode paginate és el nombre d'elements que desitgem mostrar per pàgina. Una vegada que s'han obtingut els resultats pots mostrar-los en la teua vista i crear els enllaços de paginació utilitzant el mètode <strong>render</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>&lt;div class=&quot;container&quot;&gt; 
<span class="linenos" data-linenos="2 "></span>    @foreach ($users as $user)
<span class="linenos" data-linenos="3 "></span>        {{$user-&gt;name}} 
<span class="linenos" data-linenos="4 "></span>    @endforeach
<span class="linenos" data-linenos="5 "></span>&lt;/div&gt;
<span class="linenos" data-linenos="6 "></span>{{ $users-&gt;render() }}
</code></pre></div>
<p>I açò és tot el necessari per a crear un sistema de paginació! </p>
<p>Crea la paginació per a que en el catàleg les pel.licules ixquen paginades de 8 en 8.</p>
<h3 id="exercisi-12-alertes">Exercisi 12 - Alertes<a class="headerlink" href="#exercisi-12-alertes" title="Permanent link">&para;</a></h3>
<p>El component d'Styde te un sistema de notificacions. Per a fer-lo servir cal possar en la vista on volem que ixquen les notificacions. En el nostre cas serà en la plantilla, després de mostrar el contingut:</p>
<p>master.blade.php</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>...
<span class="linenos" data-linenos="2 "></span>&lt;div id=&#39;app&#39; class=&quot;container&quot;&gt; 
<span class="linenos" data-linenos="3 "></span>    @yield(&#39;content&#39;)
<span class="linenos" data-linenos="4 "></span>    {!! Alert::render() !!}
<span class="linenos" data-linenos="5 "></span>&lt;/div&gt;
<span class="linenos" data-linenos="6 "></span>...
</code></pre></div>
<p>I ara quan guardem una pel.licula podem mostrar una notificació a l'usuari:</p>
<p>CatalogController.php</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>...
<span class="linenos" data-linenos="2 "></span>public function postCreate(StoreMovie $request){
<span class="linenos" data-linenos="3 "></span>    $movie = new Movie();
<span class="linenos" data-linenos="4 "></span>    $movie-&gt;fill($request-&gt;toArray());
<span class="linenos" data-linenos="5 "></span>    $movie-&gt;save();
<span class="linenos" data-linenos="6 "></span>    Alert::success(&quot;S&#39;ha guardat la pel.licula&quot;);
<span class="linenos" data-linenos="7 "></span>    return redirect(&#39;/catalog&#39;);
<span class="linenos" data-linenos="8 "></span>}
<span class="linenos" data-linenos="9 "></span>...
</code></pre></div>
<p>Possa els missatges als mètodes de la pel.licula.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2024 Xavier Sastre - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "toc.integrate", "content.tabs.link", "navigation.expand"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copiat al porta-retalls", "clipboard.copy": "C\u00f2pia al porta-retalls", "search.result.more.one": "1 m\u00e9s en aquesta p\u00e0gina", "search.result.more.other": "# m\u00e9s en aquesta p\u00e0gina", "search.result.none": "Cap document coincideix", "search.result.one": "1 document coincident", "search.result.other": "# documents coincidents", "search.result.placeholder": "Escriu per a comen\u00e7ar a cercar", "search.result.term.missing": "Desaparegut", "select.version": "Selecciona la versi\u00f3"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>